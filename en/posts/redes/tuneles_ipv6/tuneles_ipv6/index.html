<!doctype html><html lang=en><head><title>IPv6 Tunnels</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.ddf4c4775d35e5bc3dd64c797b179f99eaf85cf9811e64bd08f8c44a68d0b229.css integrity="sha256-3fTEd1015bw91kx5exefmer4XPmBHmS9CPjESmjQsik="><link rel=icon type=image/png href=/images/site/avatar_hu_f10227dc088ad43a.jpg><meta property="og:title" content="Atlas"><meta property="og:type" content="website"><meta property="og:description" content="Portfolio and personal blog of Francisco Javier Cruces Doval"><meta property="og:image" content="/images/author/john.png"><meta property="og:url" content="https://www.javiercd.es"><meta name=description content="In this detailed post, we explore the process of configuring IPv6 to IPv4 tunnels and vice versa in Linux and Cisco environments. As the migration to IPv6 gains importance, the ability to establish communication between IPv4 and IPv6 networks becomes essential. We will cover the basics of tunnel configuration, including the most common types of tunnels, such as 6to4 and Teredo. Additionally, we will provide step-by-step instructions for configuration on both Linux systems and Cisco devices."><script async src="https://www.googletagmanager.com/gtag/js?id=G-GVDYVWJLRH"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GVDYVWJLRH")}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GVDYVWJLRH"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GVDYVWJLRH")}</script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/en><img src=/images/site/masthead_hu_f10227dc088ad43a.png id=logo alt=Logo>
Atlas</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/en#home>Home</a></li><li class=nav-item><a class=nav-link href=/en#about>About Me</a></li><li class=nav-item><a class=nav-link href=/en#skills>Skills</a></li><li class=nav-item><a class=nav-link href=/en#education>Education</a></li><li class=nav-item><a class=nav-link href=/en#recent-posts>Recent Posts</a></li><li class=nav-item><a class=nav-link href=/en#accomplishments>Certifications</a></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/en/posts>Posts</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=languageSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="fi fi-gb"></span>
English</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/posts/redes/tuneles_ipv6/tuneles_ipv6><span class="fi fi-es"></span>
Español
</a><a class="dropdown-item nav-link languages-item" href=/en/posts/redes/tuneles_ipv6/tuneles_ipv6><span class="fi fi-gb"></span>
English</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/masthead_hu_f10227dc088ad43a.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/masthead_hu_f10227dc088ad43a.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/en/search><input type=text name=keyword placeholder=Search data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/en/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/ci_cd/> CI / CD Jenkins</a><ul><li><a class=list-link href=/en/posts/ci_cd/practica_jenkins/ title="CI / CD practice with Jenkins">CI / CD practice with Jenkins</a></li><li><a class=list-link href=/en/posts/ci_cd/taller1_jenkins/ title="Workshop 1 Ortho-rector of markdown documents (test)">Workshop 1 Ortho-rector of markdown documents (test)</a></li><li><a class=list-link href=/en/posts/ci_cd/taller2_jenkins/ title="Workshop 2 Valid HTML5 check and surge.sh deployment (test and deploy)">Workshop 2 Valid HTML5 check and surge.sh deployment (test and deploy)</a></li><li><a class=list-link href=/en/posts/ci_cd/taller3_jenkins/ title="Workshop 3 Continuous integration of django application (Test)">Workshop 3 Continuous integration of django application (Test)</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/base_de_datos/> Database</a><ul><li><a class=list-link href=/en/posts/base_de_datos/instalar_mariadb/ title="Install MariaDB in Debian">Install MariaDB in Debian</a></li><li><a class=list-link href=/en/posts/base_de_datos/interconexion_de_servidores/ title="Interconnection of database servers">Interconnection of database servers</a></li><li><a class=list-link href=/en/posts/base_de_datos/instalacion_oracle_19c_debian12/ title="Oracle 19c installation under Debian 12">Oracle 19c installation under Debian 12</a></li><li><a class=list-link href=/en/posts/base_de_datos/instalar_postgresql/ title="PostgreSQL installation in Debian 12">PostgreSQL installation in Debian 12</a></li><li><a class=list-link href=/en/posts/base_de_datos/oracle_acceso_remoto/ title="Remote access configuration in Oracle">Remote access configuration in Oracle</a></li><li><a class=list-link href=/en/posts/base_de_datos/acceso_remoto_mariadb/ title="Remote access in MariaDB">Remote access in MariaDB</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/docker/> Docker</a><ul><li><a class=list-link href=/en/posts/docker/instalar_docker_compose/ title="Docker Compose Installation on Ubuntu 24">Docker Compose Installation on Ubuntu 24</a></li><li><a class=list-link href=/en/posts/docker/instalar_docker_ubuntu24/ title="Docker Installation on Ubuntu 24">Docker Installation on Ubuntu 24</a></li><li><a class=list-link href=/en/posts/docker/taller1/ title="Workshop 1 Storage and networks in Docker">Workshop 1 Storage and networks in Docker</a></li><li><a class=list-link href=/en/posts/docker/taller2/ title="Workshop 2 Multicontainer Scenarios in Docker">Workshop 2 Multicontainer Scenarios in Docker</a></li><li><a class=list-link href=/en/posts/docker/taller3/ title="Workshop 3 Image creation Docker">Workshop 3 Image creation Docker</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/cortafuegos/> Firewall</a><ul><li><a class=list-link href=/en/posts/cortafuegos/fortinet_cli/ title="Fortinet CLI">Fortinet CLI</a></li><li><a class=list-link href=/en/posts/cortafuegos/fortinet_uno/ title="Perimetral with Fortinet I">Perimetral with Fortinet I</a></li><li><a class=list-link href=/en/posts/cortafuegos/fortinet_dos/ title="Perimetral with Fortinet II">Perimetral with Fortinet II</a></li><li><a class=list-link href=/en/posts/cortafuegos/nftables_uno/ title="Perimetral with Nftables I">Perimetral with Nftables I</a></li><li><a class=list-link href=/en/posts/cortafuegos/nftables_dos/ title="Perimetral with Nftables II">Perimetral with Nftables II</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/drivers/> Linux Drivers</a><ul><li><a class=list-link href=/en/posts/drivers/nvidia_driver/ title="Drivers Nvidia">Drivers Nvidia</a></li><li><a class=list-link href=/en/posts/drivers/nvidia_optimus/ title="How to choose which graph to use on my laptop with Linux">How to choose which graph to use on my laptop with Linux</a></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/en/posts/redes/> Networks</a><ul class=active><li><a class=list-link href=/en/posts/redes/android_gns3/ title="Android GNS3-KVM">Android GNS3-KVM</a></li><li><a class=list-link href=/en/posts/redes/escenario_ipv6_basico/ title="Basic IPv6 scenario">Basic IPv6 scenario</a></li><li><a class=list-link href=/en/posts/redes/instalacion_wireshark_gns3/ title="GNS3 and Wireshark installation">GNS3 and Wireshark installation</a></li><li><a class=list-link href=/en/posts/redes/instalar_gns3_debian12/ title="GNS3 installation in Debian 12">GNS3 installation in Debian 12</a></li><li><a class=list-link href=/en/posts/redes/switches_gns3/ title="GNS3 switch configuration">GNS3 switch configuration</a></li><li><a class="active list-link" href=/en/posts/redes/tuneles_ipv6/ title="IPV6 Tunnels">IPV6 Tunnels</a></li><li><a class=list-link href=/en/posts/redes/configuracion_de_nat/ title="NAT in Cisco and Linux">NAT in Cisco and Linux</a></li><li><a class=list-link href=/en/posts/redes/comandos_de_supervision_de_redes/ title="Network monitoring commands">Network monitoring commands</a></li><li><a class=list-link href=/en/posts/redes/enroutamiento_openstack/ title="OpenStack routing">OpenStack routing</a></li><li><a class=list-link href=/en/posts/redes/arp/ title="Protocol ARP">Protocol ARP</a></li><li><a class=list-link href=/en/posts/redes/underworld/ title=Underworld>Underworld</a></li><li><a class=list-link href=/en/posts/redes/underworld_evolution/ title="Underworld evolution">Underworld evolution</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/observabilidad/> Observability</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/observabilidad/metricas/> Metrics</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/observabilidad/metricas/prometheus/> Prometheus</a><ul><li><a class=list-link href=/en/posts/observabilidad/metricas/prometheus/instalacion_basica_docker_compose/ title="Installation of Prometheus with Docker Compose and Node Exporter on Debian 12">Installation of Prometheus with Docker Compose and Node Exporter on Debian 12</a></li></ul></li></ul></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/seguridad/> Security</a><ul><li><a class=list-link href=/en/posts/seguridad/forense/ title="Forensic computer">Forensic computer</a></li><li><a class=list-link href=/en/posts/seguridad/https_autofirmado/ title=HTTPS>HTTPS</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/servicios/> Services</a><ul><li><a class=list-link href=/en/posts/servicios/apache/ title=Apache>Apache</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/servicios/dhcp/> DHCP</a><ul><li><a class=list-link href=/en/posts/servicios/dhcp/instalacion_y_configuracion_de_un_servidor_dhcp_en_linux/ title="Installation and Configuration of a DHCP Server on Linux">Installation and Configuration of a DHCP Server on Linux</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/servicios/dns/> DNS</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/servicios/dns/bind9/> BIND9</a><ul><li><a class=list-link href=/en/posts/servicios/dns/bind9/dns_esclavo/ title="Configuring a Slave DNS Server with BIND9">Configuring a Slave DNS Server with BIND9</a></li><li><a class=list-link href=/en/posts/servicios/dns/bind9/instalacion_basica/ title="Installation and Configuration of BIND9 on Linux">Installation and Configuration of BIND9 on Linux</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/servicios/dns/dnsmasq/> DNSMASQ</a><ul><li><a class=list-link href=/en/posts/servicios/dns/dnsmasq/instalacion_basica/ title="Local Server with DNSMasq">Local Server with DNSMasq</a></li></ul></li></ul></li><li><a class=list-link href=/en/posts/servicios/ftp/ title=FTP>FTP</a></li><li><a class=list-link href=/en/posts/servicios/nat_iptables/ title="NAT with iptables">NAT with iptables</a></li><li><a class=list-link href=/en/posts/servicios/ssh/ title=SSH>SSH</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/sistemas/> Systems</a><ul><li><a class=list-link href=/en/posts/sistemas/ad_ubuntu/ title="Active Directory in Ubuntu">Active Directory in Ubuntu</a></li><li><a class=list-link href=/en/posts/sistemas/recoleccion_logs_journald/ title="Centralized collection of logs journald">Centralized collection of logs journald</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/sistemas/compilaciones_linux/> Compilations in LINUX</a><ul><li><a class=list-link href=/en/posts/sistemas/compilaciones_linux/compilacion_de_un_programa_en_c_utilizando_un_makefile/ title="Compilation of a C-program using a Makefile">Compilation of a C-program using a Makefile</a></li><li><a class=list-link href=/en/posts/sistemas/compilaciones_linux/compilacion_de_un_kernel/ title="Compilation of a kernel">Compilation of a kernel</a></li></ul></li><li><a class=list-link href=/en/posts/sistemas/creacion_de_un_sistema_automatizado_de_instalacion/ title="Creation of an automated installation system">Creation of an automated installation system</a></li><li><a class=list-link href=/en/posts/sistemas/samba_debian/ title="Install and configure samba in Debian">Install and configure samba in Debian</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/sistemas/comandos_linux/> Linux Command</a><ul><li><a class=list-link href=/en/posts/sistemas/comandos_linux/ejercicios_de_modificacion_de_parametros_del_kernel/ title="Kernel parameter modification exercises">Kernel parameter modification exercises</a></li><li><a class=list-link href=/en/posts/sistemas/comandos_linux/comandos_procesos/ title="Linux processes">Linux processes</a></li><li><a class=list-link href=/en/posts/sistemas/comandos_linux/ejercicios_de_manejo_de_modulos/ title="Module management exercises">Module management exercises</a></li><li><a class=list-link href=/en/posts/sistemas/comandos_linux/gestion_de_paquetes/ title="Package management">Package management</a></li><li><a class=list-link href=/en/posts/sistemas/comandos_linux/empaquetadores_compresores/ title="Packaging and compressors">Packaging and compressors</a></li><li><a class=list-link href=/en/posts/sistemas/comandos_linux/ejercicios_gestion_de_paqueteria/ title="Paid management exercises">Paid management exercises</a></li><li><a class=list-link href=/en/posts/sistemas/comandos_linux/programacion_tareas/ title="Task programming">Task programming</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/sistemas/migraciones/> Migration in Linnux</a><ul><li><a class=list-link href=/en/posts/sistemas/migraciones/migracion_sistema_de_ficheros/ title="File system">File system</a></li><li><a class=list-link href=/en/posts/sistemas/migraciones/paso_de_centos_stream_8_a_centos_stream_9/ title="Migtation from CentOS stream 8 to CentOS stream 9">Migtation from CentOS stream 8 to CentOS stream 9</a></li><li><a class=list-link href=/en/posts/sistemas/migraciones/eliminacion_systemd/ title="Systemd elimination">Systemd elimination</a></li><li><a class=list-link href=/en/posts/sistemas/migraciones/transformacion_instancia_cloud/ title="Transformation instance cloud">Transformation instance cloud</a></li></ul></li><li><a class=list-link href=/en/posts/sistemas/nfs_debian/ title="NFS in Debian">NFS in Debian</a></li><li><a class=list-link href=/en/posts/sistemas/activacion_selinux/ title="SELinux activation configuration">SELinux activation configuration</a></li><li><a class=list-link href=/en/posts/sistemas/comparticion_de_directorios_en_windows/ title="Share resources in Windows">Share resources in Windows</a></li><li><a class=list-link href=/en/posts/sistemas/ssh_windows/ title="Ssh service in Windows">Ssh service in Windows</a></li><li><a class=list-link href=/en/posts/sistemas/almacenamiento_servidor_independiente/ title="Storage Spaces in Windows Server">Storage Spaces in Windows Server</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/vpn/> VPN</a><ul><li><a class=list-link href=/en/posts/vpn/comparativa_ovpn_wire/ title="OpenVPN and Wireguard Comparative">OpenVPN and Wireguard Comparative</a></li><li><a class=list-link href=/en/posts/vpn/acceso_remoto_openvpn/ title="OpenVPN remote access">OpenVPN remote access</a></li><li><a class=list-link href=/en/posts/vpn/acceso_remoto_strongswang/ title="Remote access Ipsec StrongSwan">Remote access Ipsec StrongSwan</a></li><li><a class=list-link href=/en/posts/vpn/ipsec_cisco/ title="Site-to-Site IPsec Cisco">Site-to-Site IPsec Cisco</a></li><li><a class=list-link href=/en/posts/vpn/site_to_site_fortinet/ title="Site-to-Site IPsec Fortinet">Site-to-Site IPsec Fortinet</a></li><li><a class=list-link href=/en/posts/vpn/site_to_site_openvpn/ title="Site-to-Site OpenVPN">Site-to-Site OpenVPN</a></li><li><a class=list-link href=/en/posts/vpn/site_to_site_wireguard/ title="Site-to-Site Wireguard">Site-to-Site Wireguard</a></li><li><a class=list-link href=/en/posts/vpn/acceso_remoto_wireguard/ title="Wireguard remote access">Wireguard remote access</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/en/posts/iaw/> Web applications</a><ul><li><a class=list-link href=/en/posts/iaw/lamp/ title="LAMP stack installation">LAMP stack installation</a></li><li><a class=list-link href=/en/posts/iaw/lemp/ title="LEMP stack installation">LEMP stack installation</a></li><li><a class=list-link href=/en/posts/iaw/wordpress/ title="WordPress LAMP">WordPress LAMP</a></li><li><a class=list-link href=/en/posts/iaw/wordpress_lemp/ title="WordPress LEMP">WordPress LEMP</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/redes/tuneles_ipv6/portada.png)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hu_2aff0fda0501496d.png alt="Author Image"><h5 class=author-name>Francisco Javier Cruces Doval</h5><p class=text-muted>Friday, September 8, 2023 | 10 minutes</p></div><div class=title><h1>IPv6 Tunnels</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/en/tags/networking/ class="btn btn-sm btn-info">Networking</a></li><li class=rounded><a href=/en/tags/ipv6/ class="btn btn-sm btn-info">IPv6</a></li><li class=rounded><a href=/en/tags/ipv4/ class="btn btn-sm btn-info">IPv4</a></li><li class=rounded><a href=/en/tags/cisco/ class="btn btn-sm btn-info">Cisco</a></li><li class=rounded><a href=/en/tags/linux/ class="btn btn-sm btn-info">Linux</a></li></ul></div><div class=post-content id=post-content><h2 id=introduction>Introduction</h2><p>In this detailed post, we explore the process of configuring IPv6 to IPv4 tunnels and vice versa in Linux and Cisco environments. As the migration to IPv6 gains importance, the ability to establish communication between IPv4 and IPv6 networks becomes essential. We will cover the basics of tunnel configuration, including the most common types of tunnels, such as 6to4 and Teredo. Additionally, we will provide step-by-step instructions for configuration on both Linux systems and Cisco devices.</p><h2 id=6to4-tunnels-in-cisco>6to4 Tunnels in Cisco</h2><h3 id=1-configuration-of-router-network-interfaces>1. Configuration of Router Network Interfaces</h3><h4 id=r1>R1</h4><ul><li><strong>FastEthernet 0/0</strong><ul><li>Network Prefix: <code>3333:db7::/64</code></li><li>Link: <code>FE80::C801:20FF:FE69:0</code></li><li>Global: <code>3333:DB7::C801:20FF:FE69:0</code></li></ul></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.002.png alt></p><ul><li><strong>FastEthernet 1/0</strong></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.004.png alt></p><ul><li><strong>FastEthernet 2/0</strong></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.005.png alt></p><p>For R1 router clients, we will configure SLAAC:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.006.png alt></p><h4 id=r2>R2</h4><ul><li><strong>FastEthernet 0/0</strong><ul><li>Network Prefix: <code>3333:db7:1::/64</code></li><li>Link: <code>FE80::C802:20FF:FE79:0</code></li><li>Global: <code>3333:DB7:1:0:C802:20FF:FE79:0</code></li></ul></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.007.png alt></p><ul><li><strong>FastEthernet 1/0</strong></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.009.png alt></p><ul><li><strong>FastEthernet 2/0</strong></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.010.png alt></p><p>For R2 router clients, we will configure SLAAC:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.011.png alt></p><h4 id=r3>R3</h4><ul><li><strong>FastEthernet 0/0</strong><ul><li>Network Prefix: <code>3333:db7:2::/64</code></li><li>Link: <code>FE80::C803:20FF:FE89:0</code></li><li>Global: <code>3333:DB7:2:0:C803:20FF:FE89:0</code></li></ul></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.012.png alt></p><ul><li><strong>FastEthernet 1/0</strong></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.014.png alt></p><ul><li><strong>FastEthernet 2/0</strong></li></ul><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.015.png alt></p><p>For R3 router clients, we will configure SLAAC:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.016.png alt></p><blockquote><p><strong>Note:</strong> In this scenario, it is not necessary to manually configure IPv4 routes, as the network interface configuration will make IPv4 traffic routable.</p></blockquote><h2 id=2-gre-tunnels>2. GRE Tunnels</h2><p>GRE is an unsecured site-to-site VPN tunneling protocol that can encapsulate a wide variety of protocol packets within IP tunnels. This allows an organization to transmit other protocols over an IP-based WAN.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.017.png alt></p><p>This allows adding an IPv4 header to an IPv6 packet so it can travel over IPv4 networks.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.018.jpeg alt></p><h4 id=r1--r3>R1 → R3</h4><p>We will create a tunnel interface:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.019.png alt></p><h1 id=gre-tunnel-configuration-with-ipv6-over-ipv4>GRE Tunnel Configuration with IPv6 over IPv4</h1><p>We set the tunnel mode to GRE with IP, which will encapsulate our IPv6 packets within IPv4:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.020.png alt></p><p>We assign an IPv4 address to our tunnel:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.021.png alt></p><p>We set the WAN address of our router, FastEthernet 1/0:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.022.png alt></p><p>We set the WAN address of the tunnel endpoint (R2):</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.023.png alt></p><p>We enable OSPF, which is a dynamic routing protocol:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.024.png alt></p><p>This command adds the tunnel network to OSPF:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.025.png alt></p><p>We assign an IPv6 address to our tunnel, with the network prefix <code>2002</code> based on the router&rsquo;s IPv4 address <code>2002:0A00:0001::1/64</code>:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.026.png alt></p><p>We create the route to reach the network:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.044.png alt></p><p>We create a tunnel interface:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.028.png alt></p><p>We set the tunnel mode to GRE with IP, which will encapsulate our IPv6 packets within IPv4:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.029.png alt></p><p>We assign an IPv4 address to our tunnel:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.030.png alt></p><p>We set the WAN address of our router, FastEthernet 1/0:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.031.png alt></p><p>We set the WAN address of the tunnel endpoint (R2):</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.032.png alt></p><p>We enable OSPF, which is a dynamic routing protocol:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.033.png alt></p><p>This command adds the tunnel network to OSPF:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.034.png alt></p><p>We assign an IPv6 address to our tunnel, with the network prefix <code>2002</code> based on the router&rsquo;s IPv4 address <code>2002:0A00:0002::1/64</code>:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.035.png alt></p><p>We create the route to reach the network:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.044.png alt></p><p>We create a tunnel interface:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.036.png alt></p><p>We set the tunnel mode to GRE with IP, which will encapsulate our IPv6 packets within IPv4:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.037.png alt></p><p>We assign an IPv4 address to our tunnel:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.038.png alt></p><p>We set the WAN address of our router, FastEthernet 1/0:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.039.png alt></p><p>We set the WAN address of the tunnel endpoint (R2):</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.040.png alt></p><p>We enable OSPF, which is a dynamic routing protocol:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.041.png alt></p><p>This command adds the tunnel network to OSPF:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.042.png alt></p><p>We assign an IPv6 address to our tunnel, with the network prefix <code>2002</code> based on the router&rsquo;s IPv4 address <code>2002:1400:0001</code>:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.043.png alt></p><p>We create the route to reach the network:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.044.png alt></p><h2 id=r3--r1><strong>R3 → R1</strong></h2><p>We create a tunnel interface:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.045.png alt></p><p>We set the tunnel mode to GRE with IP, which will encapsulate our IPv6 packets within IPv4:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.046.png alt></p><p>We assign an IPv4 address to our tunnel:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.047.png alt></p><p>We set the WAN address of our router, FastEthernet 1/0:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.048.png alt></p><p>We set the WAN address of the tunnel endpoint (R2):</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.049.png alt></p><p>We enable OSPF, which is a dynamic routing protocol:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.050.png alt></p><p>This command adds the tunnel network to OSPF:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.051.png alt></p><p>We assign an IPv6 address to our tunnel, with the network prefix <code>2002</code> based on the router&rsquo;s IPv4 address <code>2002:1400:0002::1/64</code>:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.052.png alt></p><p>We create the route to reach the network:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.053.png alt></p><hr><h2 id=r3--r2><strong>R3 → R2</strong></h2><p>We create a tunnel interface:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.054.png alt></p><p>We set the tunnel mode to GRE with IP, which will encapsulate our IPv6 packets within IPv4:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.055.png alt></p><p>We assign an IPv4 address to our tunnel:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.056.png alt></p><p>We set the WAN address of our router, FastEthernet 1/0:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.057.png alt></p><p>We set the WAN address of the tunnel endpoint (R2):</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.058.png alt></p><p>We enable OSPF, which is a dynamic routing protocol:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.059.png alt></p><p>This command adds the tunnel network to OSPF:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.060.png alt></p><p>We assign an IPv6 address to our tunnel, with the network prefix <code>2002</code> based on the router&rsquo;s IPv4 address <code>30.0.0.2 → 2002:1e00:0002::1/64</code>:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.061.png alt></p><p>We create the route to reach the network:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.062.png alt></p><hr><h2 id=r2--r3><strong>R2 → R3</strong></h2><p>We create a tunnel interface:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.063.png alt></p><p>We set the tunnel mode to GRE with IP, which will encapsulate our IPv6 packets within IPv4:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.064.png alt></p><p>We assign an IPv4 address to our tunnel:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.065.png alt></p><p>We set the WAN address of our router, FastEthernet 1/0:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.066.png alt></p><p>We set the WAN address of the tunnel endpoint (R2):</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.067.png alt></p><p>We enable OSPF, which is a dynamic routing protocol:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.068.png alt></p><p>This command adds the tunnel network to OSPF:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.069.png alt></p><p>We assign an IPv6 address to our tunnel, with the network prefix <code>2002</code> based on the router&rsquo;s IPv4 address <code>30.0.0.1 → 2002:1e00:0001::1/64</code>:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.070.png alt></p><p>We create the route to reach the network:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.071.png alt></p><hr><h3 id=3-functionality-verification>3. Functionality Verification</h3><p>We will verify that the tunnels have been created. To do this, we will enter the following command on the three routers in our scenario:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.072.png alt></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.073.png alt></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.074.png alt></p><p>This will appear once both ends of the tunnel have been created. If not, nothing will appear. In our case, we can see that the tunnels have been successfully created.</p><hr><h4 id=ping>Ping</h4><p>We will verify the functionality of the tunnels by performing a ping.</p><ul><li><strong>PC1 → 3333:db7::e60:ddff:fea6:0</strong></li><li><strong>PC2 → 3333:db7:1:0:e2e:3bff:fe83:0</strong></li><li><strong>PC3 → 3333:db7:2:0:e62:5dff:fedf:0</strong></li></ul><p><strong>PC1 → PC2</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.075.png alt></p><p><strong>PC1 → PC3</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.076.png alt></p><p><strong>PC2 → PC1</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.077.png alt></p><p><strong>PC2 → PC3</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.078.png alt></p><p><strong>PC3 → PC1</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.079.png alt></p><p><strong>PC3 → PC2</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.080.png alt></p><p>We can see that we have connectivity between all the machines in our scenario using IPv6, even though we have to traverse IPv4 networks.</p><hr><h4 id=traceroute>Traceroute</h4><p>We will verify the path that the packets follow.</p><p><strong>Path of a packet from PC1 to PC2:</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.081.png alt></p><p><strong>Path of a packet from PC1 to PC3:</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.082.png alt></p><p><strong>Path of a packet from PC2 to PC1:</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.083.png alt></p><p><strong>Path of a packet from PC2 to PC3:</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.084.png alt></p><p><strong>Path of a packet from PC3 to PC1:</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.085.png alt></p><p><strong>Path of a packet from PC3 to PC2:</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.086.png alt></p><hr><h3 id=4-study-of-an-encapsulated-packet>4. Study of an Encapsulated Packet</h3><p><strong>Before Passing Through the Tunnel</strong></p><p>A packet traveling from PC1 to PC2.</p><p>We can see that, since it has not yet passed through the tunnel, it does not have IPv4 headers, only IPv6. We can see that the source is PC1 and the destination is PC3:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.087.jpeg alt></p><p>We will see how, in the next segment, once it passes through the tunnel, the router will add an IPv4 header so it can traverse that segment.</p><hr><h2 id=after-passing-through-the-tunnel><strong>After Passing Through the Tunnel</strong></h2><p>If we look at a packet that has passed through a tunnel, we can see that it has &ldquo;2 network layers&rdquo;:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.088.png alt></p><p>If we look at the network layer, we see that the source and destination IPs are those of the tunnel endpoints. Additionally, we see that it uses protocol 47, which means it has passed through a GRE tunnel.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.089.jpeg alt></p><p>Finally, we can see in the IPv6 header that it is indistinguishable from one that has not passed through a tunnel.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.090.jpeg alt></p><hr><h2 id=once-it-reaches-the-destination-network><strong>Once It Reaches the Destination Network</strong></h2><p>We see that, once it reaches the destination (i.e., after traversing the IPv4 segment and re-entering the IPv6 network), the router will remove the IPv4 header and leave the IPv6 header so the packet can reach its destination.</p><p>We see that the IPv6 header remains intact; it is the same throughout the packet&rsquo;s journey:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.091.jpeg alt></p><hr><h2 id=6to4-tunnels-in-linux>6to4 Tunnels in Linux</h2><h3 id=1-network-interface-configuration>1. Network Interface Configuration</h3><p>I will respect the IPv4 addresses from the Cisco scenario.</p><h4 id=r1-1><strong>R1</strong></h4><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.093.jpeg alt></p><p>To apply the configuration, we will run <code>sudo systemctl restart networking.service</code>.</p><p>I will configure SLAAC to set up the clients on our IPv6 network. First, we need to install the <code>radvd</code> package with <code>sudo apt install radvd</code>.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.094.png alt></p><p>Once the service is configured, we will restart <code>radvd</code>, and our clients will automatically configure themselves with the specified prefix.</p><h4 id=r2-1><strong>R2</strong></h4><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.095.jpeg alt></p><p>To apply the configuration, we will run <code>sudo systemctl restart networking.service</code>.</p><p>I will configure SLAAC to set up the clients on our IPv6 network. First, we need to install the <code>radvd</code> package with <code>sudo apt install radvd</code>.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.096.png alt></p><p>Once the service is configured, we will restart <code>radvd</code>, and our clients will automatically configure themselves with the specified prefix.</p><h4 id=r3-1><strong>R3</strong></h4><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.097.jpeg alt></p><p>To apply the configuration, we will run <code>sudo systemctl restart networking.service</code>.</p><p>I will configure SLAAC to set up the clients on our IPv6 network. First, we need to install the <code>radvd</code> package with <code>sudo apt install radvd</code>.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.098.png alt></p><p>Once the service is configured, we will restart <code>radvd</code>, and our clients will automatically configure themselves with the specified prefix.</p><hr><p><strong>Note:</strong> In this scenario, it is not necessary to manually configure IPv4 routes, as the network interface configuration will make IPv4 traffic routable.</p><p>However, it will be necessary to enable the forwarding bit for both IPv4 and IPv6 on all routers.</p><p>To do this, we edit the file <code>sudo nano /etc/sysctl.conf</code> and uncomment the following lines:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.099.jpeg alt></p><p>We will repeat this for each of our routers and reboot to apply the changes.</p><hr><h3 id=2-sit-tunnel-configuration>2. SIT Tunnel Configuration</h3><p>The operation is similar to GRE tunnels in Cisco. This will take our packets and, through a tunnel interface, add an IPv4 header so they can traverse IPv4 networks.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.100.png alt></p><p>Once the tunnel is up, we will tell the router that to reach the prefix of network X, it must use this tunnel to add the header to our packets.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.101.png alt></p><p>For convenience, I have created a small script on each router with the necessary commands to make the tunnel work.</p><p>It consists of 4 commands:</p><ol><li>It will create the tunnel interface with the destination and then the source.</li><li>It will bring up the network interface.</li><li>It will assign the IPv6 address to the tunnel based on the source IPv4 address.</li><li>We will create the route for the traffic that will use the tunnel.</li></ol><p>We can name the tunnel as we wish. In my case, I have named it <code>tunnel</code> followed by a number to identify them.</p><hr><h2 id=r2-tunnels><strong>R2 Tunnels</strong></h2><p>This is what the &ldquo;script&rdquo; for R2 tunnels would look like:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.102.png alt></p><p>Once the script is created, we will give it permissions and execute it:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.103.png alt></p><p>We will verify that the interfaces have been created correctly:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.104.jpeg alt></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.105.jpeg alt></p><hr><h2 id=r3-tunnels><strong>R3 Tunnels</strong></h2><p>This is what the &ldquo;script&rdquo; for R3 tunnels would look like:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.106.png alt></p><p>Once the script is created, we will give it permissions and execute it:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.107.png alt></p><p>We will verify that the interfaces have been created correctly:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.108.jpeg alt></p><hr><h3 id=3-functionality-verification-1>3. Functionality Verification</h3><ul><li><strong>PC1 → 3333:db7::e47:bfff:fe86:0</strong></li><li><strong>PC2 → 2222:db7::ebc:f6ff:fe7d:0</strong></li><li><strong>PC3 → 4444:db7::e43:78ff:fec6:0</strong></li></ul><h4 id=ping-1>Ping</h4><p><strong>PC1 → PC2</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.109.png alt></p><p><strong>PC1 → PC3</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.110.png alt></p><p><strong>PC2 → PC1</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.111.png alt></p><p><strong>PC2 → PC3</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.112.png alt></p><p><strong>PC3 → PC1</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.113.png alt></p><p><strong>PC3 → PC2</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.114.png alt></p><hr><h4 id=traceroute-1>Traceroute</h4><p>Once we have verified connectivity, we will check if the packets use the tunnels.</p><p><strong>PC1 → PC2</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.115.png alt></p><p><strong>PC1 → PC3</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.116.png alt></p><p><strong>PC2 → PC1</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.117.png alt></p><p><strong>PC2 → PC3</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.118.png alt></p><p><strong>PC3 → PC1</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.119.png alt></p><p><strong>PC3 → PC2</strong></p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.120.png alt></p><hr><h3 id=4-study-of-an-encapsulated-packet-1>4. Study of an Encapsulated Packet</h3><h4 id=before-passing-through-the-tunnel><strong>Before Passing Through the Tunnel</strong></h4><p>A packet traveling from PC1 to PC2.</p><p>We can see that, since it has not yet passed through the tunnel, it does not have IPv4 headers, only IPv6. We can see that the source is PC1 and the destination is PC3:</p><p>We will see how, in the next segment, once it passes through the tunnel, the router will add an IPv4 header so it can traverse that segment.</p><hr><h4 id=after-passing-through-the-tunnel-1><strong>After Passing Through the Tunnel</strong></h4><p>If we look at a packet that has passed through a tunnel, we can see that it has &ldquo;2 network layers&rdquo;.</p><p>If we look at the network layer, we see that the source and destination IPs are those of the tunnel endpoints. Additionally, we see that it uses protocol 47, which means it has passed through a GRE tunnel.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.122.jpeg alt></p><p>Finally, we can see in the IPv6 header that it is indistinguishable from one that has not passed through a tunnel.</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.123.jpeg alt></p><hr><h4 id=once-it-reaches-the-destination-network-1><strong>Once It Reaches the Destination Network</strong></h4><p>We see that, once it reaches the destination (i.e., after traversing the IPv4 segment and re-entering the IPv6 network), the router will remove the IPv4 header and leave the IPv6 header so the packet can reach its destination.</p><p>We see that the IPv6 header remains intact; it is the same throughout the packet&rsquo;s journey:</p><p><img src=/redes/tuneles_ipv6/img/Aspose.Words.c9ccb3e7-b0e3-4eb4-b70b-2432dbadc7d8.124.jpeg alt></p><hr><h2 id=bibliography>Bibliography</h2><ul><li><a href=https://community.cisco.com/t5/blogs-general/t%C3%BAneles-autom%C3%A1ticos-6to4/ba-p/4822594 target=_blank rel=noopener>6to4 Automatic Tunnels</a></li><li><a href=https://educacionadistancia.juntadeandalucia.es/centros/sevilla/pluginfile.php/347162/mod_resource/content/1/52470-Tuneles%20Automaticos%20para%20IPv6%5c%281%5c%29.pdf target=_blank rel=noopener>Automatic Tunnels for IPv6</a></li><li><a href=https://ccnadesdecero.es/tuneles-gre-caracteristicas-y-configuracion/ target=_blank rel=noopener>GRE Tunnels</a></li><li><a href=https://juncotic.com/tunel-ipv6-montando-tunel-ipv6/ target=_blank rel=noopener>SIT 6to4 Tunnels in Linux</a></li></ul></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.javiercd.es%2fen%2fposts%2fredes%2ftuneles_ipv6%2ftuneles_ipv6%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fwww.javiercd.es%2fen%2fposts%2fredes%2ftuneles_ipv6%2ftuneles_ipv6%2f&text=IPv6%20Tunnels&via=Atlas" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.javiercd.es%2fen%2fposts%2fredes%2ftuneles_ipv6%2ftuneles_ipv6%2f&title=IPv6%20Tunnels" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.javiercd.es%2fen%2fposts%2fredes%2ftuneles_ipv6%2ftuneles_ipv6%2f&title=IPv6%20Tunnels" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=IPv6%20Tunnels https%3a%2f%2fwww.javiercd.es%2fen%2fposts%2fredes%2ftuneles_ipv6%2ftuneles_ipv6%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=IPv6%20Tunnels&body=https%3a%2f%2fwww.javiercd.es%2fen%2fposts%2fredes%2ftuneles_ipv6%2ftuneles_ipv6%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/javierasping/sentinel/edit/main/content/posts/redes/tuneles_ipv6/tuneles_ipv6.en.md title="Improve this page" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Improve this page</a></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Table of Contents</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#6to4-tunnels-in-cisco>6to4 Tunnels in Cisco</a><ul><li><a href=#1-configuration-of-router-network-interfaces>1. Configuration of Router Network Interfaces</a><ul><li><a href=#r1>R1</a></li><li><a href=#r2>R2</a></li><li><a href=#r3>R3</a></li></ul></li></ul></li><li><a href=#2-gre-tunnels>2. GRE Tunnels</a><ul><li><ul><li><a href=#r1--r3>R1 → R3</a></li></ul></li></ul></li></ul><ul><li><a href=#r3--r1><strong>R3 → R1</strong></a></li><li><a href=#r3--r2><strong>R3 → R2</strong></a></li><li><a href=#r2--r3><strong>R2 → R3</strong></a><ul><li><a href=#3-functionality-verification>3. Functionality Verification</a><ul><li><a href=#ping>Ping</a></li><li><a href=#traceroute>Traceroute</a></li></ul></li><li><a href=#4-study-of-an-encapsulated-packet>4. Study of an Encapsulated Packet</a></li></ul></li><li><a href=#after-passing-through-the-tunnel><strong>After Passing Through the Tunnel</strong></a></li><li><a href=#once-it-reaches-the-destination-network><strong>Once It Reaches the Destination Network</strong></a></li><li><a href=#6to4-tunnels-in-linux>6to4 Tunnels in Linux</a><ul><li><a href=#1-network-interface-configuration>1. Network Interface Configuration</a><ul><li><a href=#r1-1><strong>R1</strong></a></li><li><a href=#r2-1><strong>R2</strong></a></li><li><a href=#r3-1><strong>R3</strong></a></li></ul></li><li><a href=#2-sit-tunnel-configuration>2. SIT Tunnel Configuration</a></li></ul></li><li><a href=#r2-tunnels><strong>R2 Tunnels</strong></a></li><li><a href=#r3-tunnels><strong>R3 Tunnels</strong></a><ul><li><a href=#3-functionality-verification-1>3. Functionality Verification</a><ul><li><a href=#ping-1>Ping</a></li><li><a href=#traceroute-1>Traceroute</a></li></ul></li><li><a href=#4-study-of-an-encapsulated-packet-1>4. Study of an Encapsulated Packet</a><ul><li><a href=#before-passing-through-the-tunnel><strong>Before Passing Through the Tunnel</strong></a></li><li><a href=#after-passing-through-the-tunnel-1><strong>After Passing Through the Tunnel</strong></a></li><li><a href=#once-it-reaches-the-destination-network-1><strong>Once It Reaches the Destination Network</strong></a></li></ul></li></ul></li><li><a href=#bibliography>Bibliography</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>Navigation</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/en/#about>About Me</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/en/#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/en/#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/en/#recent-posts>Recent Posts</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/en/#accomplishments>Certifications</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contact me:</h5><ul><li><a href=mailto:contacto@javiercd.es target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>contacto@javiercd.es</span></a></li><li><a href=https://github.com/javierasping target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>javierasping</span></a></li><li><a href=https://www.linkedin.com/in/javiercd target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Francisco Javier Cruces Doval</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Liability Notice:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu_b3360284c55cf72d.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Powered by
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.29119cfdb8d2f06f4caaea7b9908096b5c109c5174eab5fca7e4e0efb0ffcaa0.js integrity="sha256-KRGc/bjS8G9Mqup7mQgJa1wQnFF06rX8p+Tg77D/yqA=" defer></script></body></html>