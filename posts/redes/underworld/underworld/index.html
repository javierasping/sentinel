<!doctype html><html lang=es><head><title>Underworld</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.b392e69d247f872178b69e86e7627c960e9a0d509201625e12d22a4cedf7032b.css integrity="sha256-s5LmnSR/hyF4tp6G52J8lg6aDVCSAWJeEtIqTO33Ays="><link rel=icon type=image/png href=/images/site/avatar_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_q75_box.jpg><meta property="og:title" content="Underworld"><meta property="og:description" content="Escenario de enrutamiento y acls en cisco"><meta property="og:type" content="article"><meta property="og:url" content="https://www.javiercd.es/posts/redes/underworld/underworld/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-08T10:00:00+00:00"><meta property="article:modified_time" content="2023-09-08T10:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Underworld"><meta name=twitter:description content="Escenario de enrutamiento y acls en cisco"><meta name=description content="Escenario de enrutamiento y acls en cisco"><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png id=logo alt=Logo>
Atlas</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-toggle=collapse data-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#home>Inicio</a></li><li class=nav-item><a class=nav-link href=/#about>Sobre mi</a></li><li class=nav-item><a class=nav-link href=/#skills>Competencias</a></li><li class=nav-item><a class=nav-link href=/#education>Educación</a></li><li class=nav-item><a class=nav-link href=/#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=nav-link href=/#accomplishments>Certificaciones</a></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Búsqueda data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/posts/iaw/> Aplicaciones webs</a><ul><li><a class=list-link href=/posts/iaw/lamp/ title="Instalación pila LAMP">Instalación pila LAMP</a></li><li><a class=list-link href=/posts/iaw/lemp/ title="Instalación pila LEMP">Instalación pila LEMP</a></li><li><a class=list-link href=/posts/iaw/wordpress/ title="Wordpress LAMP">Wordpress LAMP</a></li><li><a class=list-link href=/posts/iaw/wordpress_lemp/ title="Wordpress LEMP">Wordpress LEMP</a></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/redes/> Redes</a><ul class=active><li><a class=list-link href=/posts/redes/comandos_de_supervision_de_redes/ title="Comandos de supervisión de redes">Comandos de supervisión de redes</a></li><li><a class=list-link href=/posts/redes/switches_gns3/ title="Configuración de switches en GNS3">Configuración de switches en GNS3</a></li><li><a class=list-link href=/posts/redes/enroutamiento_openstack/ title="Enrutamiento en OpenStack">Enrutamiento en OpenStack</a></li><li><a class=list-link href=/posts/redes/escenario_ipv6_basico/ title="Escenario IPv6 Básico">Escenario IPv6 Básico</a></li><li><a class=list-link href=/posts/redes/instalacion_wireshark_gns3/ title="Instalacion GNS y Wireshark">Instalacion GNS y Wireshark</a></li><li><a class=list-link href=/posts/redes/configuracion_de_nat/ title="NAT en Cisco y Linux">NAT en Cisco y Linux</a></li><li><a class=list-link href=/posts/redes/arp/ title="Protocolo ARP">Protocolo ARP</a></li><li><a class=list-link href=/posts/redes/tuneles_ipv6/ title="Túneles IPV6">Túneles IPV6</a></li><li><a class="active list-link" href=/posts/redes/underworld/ title=Underworld>Underworld</a></li><li><a class=list-link href=/posts/redes/underworld_evolution/ title="Underworld evolution">Underworld evolution</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/> Servicios</a><ul><li><a class=list-link href=/posts/servicios/apache/ title=Apache>Apache</a></li><li><a class=list-link href=/posts/servicios/dhcp/ title=DHCP>DHCP</a></li><li><a class=list-link href=/posts/servicios/dns/ title=DNS>DNS</a></li><li><a class=list-link href=/posts/servicios/ftp/ title=FTP>FTP</a></li><li><a class=list-link href=/posts/servicios/nat_iptables/ title="NAT con iptables">NAT con iptables</a></li><li><a class=list-link href=/posts/servicios/ssh/ title=SSH>SSH</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/sistemas/> Sistemas</a><ul><li><a class=list-link href=/posts/sistemas/ad_ubuntu/ title="Active Directory en Ubuntu">Active Directory en Ubuntu</a></li><li><a class=list-link href=/posts/sistemas/comparticion_de_directorios_en_windows/ title="Compartir recursos en Windows">Compartir recursos en Windows</a></li><li><a class=list-link href=/posts/sistemas/nvidia/ title="Drivers Nvidia">Drivers Nvidia</a></li><li><a class=list-link href=/posts/sistemas/empaquetadores_compresores/ title="Empaquetadores y compresores">Empaquetadores y compresores</a></li><li><a class=list-link href=/posts/sistemas/samba_debian/ title="Instalar y configurar samba en Debian">Instalar y configurar samba en Debian</a></li><li><a class=list-link href=/posts/sistemas/nfs_debian/ title="NFS en Debian">NFS en Debian</a></li><li><a class=list-link href=/posts/sistemas/comandos_procesos/ title="Procesos en Linux">Procesos en Linux</a></li><li><a class=list-link href=/posts/sistemas/programacion_tareas/ title="Programación de tareas">Programación de tareas</a></li><li><a class=list-link href=/posts/sistemas/ssh_windows/ title="Servicio ssh en Windows">Servicio ssh en Windows</a></li><li><a class=list-link href=/posts/sistemas/migracion_sistema_de_ficheros/ title="Sistema de ficheros">Sistema de ficheros</a></li><li><a class=list-link href=/posts/sistemas/almacenamiento_servidor_independiente/ title="Storage Spaces en Windows Server">Storage Spaces en Windows Server</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/redes/underworld/portada_underwolrd.webp)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hud72a20250efce9adf5aa46631dba75d3_2990_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Francisco Javier Cruces Doval</h5><p class=text-muted>viernes, 8 de septiembre de 2023 | 9 minutos</p></div><div class=title><h1>Underworld</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/redes/ class="btn btn-sm btn-info">Redes</a></li><li class=rounded><a href=/tags/wireshark/ class="btn btn-sm btn-info">Wireshark</a></li><li class=rounded><a href=/tags/gns3/ class="btn btn-sm btn-info">GNS3</a></li><li class=rounded><a href=/tags/cisco/ class="btn btn-sm btn-info">Cisco</a></li><li class=rounded><a href=/tags/enrutamiento/ class="btn btn-sm btn-info">Enrutamiento</a></li><li class=rounded><a href=/tags/acls/ class="btn btn-sm btn-info">ACLS</a></li></ul></div><div class=post-content id=post-content><h2 id=introducción>Introducción</h2><p>Vives en UNDERWORLD. En tu mundo, se presentan diferentes tipos de especies con un único fin, “cruzarse” entre sí. Estas criaturas son:</p><ul><li><p>VAMPIROS</p></li><li><p>LICÁNTROPOS: hombres lobo con la capacidad de regresar a su estado humano.</p></li><li><p>HOMBRES LOBO: hombres lobo que tras su primera conversión a lobo, no pudieron regresar a su estado humano.</p></li><li><p>HUMANOS: unos mierdecillas.</p></li><li><p>TÚ: un guerrero informático con superpoderes como darse la vuelta a un juego que todavía no ha salido al mercado o poseer la facultad de volverse invisible cuando sale de fiesta y trata de cortejar a una fémina diciéndole frases del tipo: ¿quieres que te compile el kernel nena?</p></li></ul><p>El aspecto de UNDERWORLD es el siguiente:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.001.jpeg></p><h2 id=1enturar-el-escenario>1.Enturar el escenario</h2><h3 id=tablas-de-enrutamiento-a-papel>Tablas de enrutamiento a “papel”</h3><table><thead><tr><th>ROUTER HUMANO</th><th style=text-align:left></th><th></th></tr></thead><tbody><tr><td>192.168.1.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F0/0</td></tr><tr><td>192.168.2.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.3.0/24</td><td style=text-align:left>192.168.2.2</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.4.0/24</td><td style=text-align:left>192.168.2.2</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.5.0/24</td><td style=text-align:left>192.168.2.2</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.6.0/24</td><td style=text-align:left>192.168.2.2</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.7.0/24</td><td style=text-align:left>192.168.2.2</td><td style=text-align:left>F1/0</td></tr><tr><td>0.0.0.0/0</td><td style=text-align:left>192.168.2.2</td><td style=text-align:left>F1/0</td></tr></tbody></table><hr><table><thead><tr><th>ROUTER VAMPIROS</th><th style=text-align:left></th><th></th></tr></thead><tbody><tr><td>192.168.1.0/24</td><td style=text-align:left>192.168.2.1</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.2.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.3.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F0/0</td></tr><tr><td>192.168.4.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.5.0/24</td><td style=text-align:left>192.168.4.2</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.6.0/24</td><td style=text-align:left>192.168.4.2</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.7.0/24</td><td style=text-align:left>192.168.4.2</td><td style=text-align:left>F2/0</td></tr><tr><td>0.0.0.0/0</td><td style=text-align:left>192.168.4.2</td><td style=text-align:left>F2/0</td></tr></tbody></table><hr><table><thead><tr><th>ROUTER LICÁNTROPOS</th><th style=text-align:left></th><th></th></tr></thead><tbody><tr><td>192.168.1.0/24</td><td style=text-align:left>192.168.4.1</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.2.0/24</td><td style=text-align:left>192.168.4.1</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.3.0/24</td><td style=text-align:left>192.168.4.1</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.4.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F2/0</td></tr><tr><td>192.168.5.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F0/0</td></tr><tr><td>192.168.6.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.7.0/24</td><td style=text-align:left>192.168.6.2</td><td style=text-align:left>F1/0</td></tr><tr><td>0.0.0.0/0</td><td style=text-align:left>192.168.4.1</td><td style=text-align:left>F1/0</td></tr></tbody></table><hr><table><thead><tr><th>ROUTER HOMBRE LOBO</th><th style=text-align:left></th><th></th></tr></thead><tbody><tr><td>192.168.1.0/24</td><td style=text-align:left>192.168.6.1</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.2.0/24</td><td style=text-align:left>192.168.6.1</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.3.0/24</td><td style=text-align:left>192.168.6.1</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.4.0/24</td><td style=text-align:left>192.168.6.1</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.5.0/24</td><td style=text-align:left>192.168.6.1</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.6.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F1/0</td></tr><tr><td>192.168.7.0/24</td><td style=text-align:left>0.0.0.0</td><td style=text-align:left>F0/0</td></tr><tr><td>0.0.0.0/0</td><td style=text-align:left>192.168.6.1</td><td style=text-align:left>F1/0</td></tr></tbody></table><h2 id=2configuración-direcciones-ips-interfaces>2.Configuración direcciones Ips interfaces</h2><h3 id=router-humanos>Router humanos</h3><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.002.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.003.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.004.png></p><h3 id=router-vampiros>Router vampiros</h3><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.005.jpeg></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.006.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.007.png></p><h3 id=router-licántropos>Router licántropos</h3><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.008.jpeg></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.009.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.010.png></p><h3 id=router-vampiros-1>Router vampiros</h3><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.011.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.012.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.013.png></p><h2 id=3-añadiendo-la-tabla-de-enrutamiento-a-los-routers>3. Añadiendo la tabla de enrutamiento a los routers</h2><h3 id=router-humanos-1>Router humanos</h3><p>Nos creara por defecto las rutas a las redes que estamos conectados solo necesitaremos añadir la ruta por defecto :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.014.png></p><p>Nos quedaría la tabla de enrutamiento :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.015.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.016.png></p><h3 id=router-vampiros-2>Router vampiros</h3><p>Añadiremos las siguientes rutas :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.018.png></p><p>Así quedaría la tabla de enrutamiento :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.017.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.019.png></p><h3 id=router-licántropos-1>Router licántropos</h3><p>Añadimos las siguientes rutas :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.020.png></p><p>Así quedaría nuestra tabla de enrutamiento :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.021.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.022.png></p><h3 id=router-hombres-lobo>Router hombres lobo</h3><p>Añadimos las siguientes rutas :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.023.png></p><p>Así quedaría nuestra tabla de enrutamiento :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.024.png></p><p>Guardamos la configuración :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.025.png></p><h2 id=4prueba-de-enrutamiento>4.Prueba de enrutamiento</h2><p>Para no hacer muy extenso este apartado comprobare que desde PC1 llego a todos los PCs:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.026.png></p><h2 id=5configuración-acls>5.Configuración ACLs</h2><p>Todo el mundo utiliza la red para mandarse mensajitos y ligar (por lo que deberás configurar la red para que esto sea posible en un principio, es decir, que todos los equipos tengan conexión entre sí). Tú, que ya estás hasta la *#%?! de tanto bicho raro como consecuencia de los cruces que se producen cuando un vampiro se cruza por ejemplo con un licántropo y el hijo de éstos con un hombre lobo y así sucesivamente, decides ponerle fin a la historia haciendo lo siguiente, metiéndole unas cuantas ACLs a los routers que los comunican:</p><ol><li><strong>Los VAMPIROS no podrán comunicarse con el resto de especies.</strong></li></ol><p>Creamos la regla para denegar el trafico de la red 192.168.3.0:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.027.png></p><p>La aplicamos a la interfaz FastEthernet 0/0(192.168.3.1) y la aplicamos a la salida de esta :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.028.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.029.png></p><p>Comprobaremos que los PCs de la red de Vampiros no pueden comunicarse con el resto , nos dice que hay una ACL cortándonos el paso :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.030.jpeg></p><p>Si desde cualquier otro reino nos comunicamos con ellos los mensajes serán capaces de llegar a ellos sin embargo la respuesta no llegaran ya que la ACL lo impide , la respuesta es cortada ya que sale de la red de los vampiros :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.031.png></p><ol start=2><li><strong>Los HOMBRES LOBO y los LICÁNTROPOS, dado que no son tan repulsivos cuando se cruzan, podrán comunicarse entre sí. Con el resto de especies no tendrán comunicación.</strong></li></ol><p>Este apartado podemos darle diferentes soluciones , yo he optado por poner una ACL , en la interfaz F2/0 del router de licántropos .</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.032.jpeg></p><p>Creamos la ACL :</p><p>Y la aplicamos de salida de la interfaz F2/0 de salida :<img alt=ref1 src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.033.png><img alt=ref2 src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.034.png></p><p>Comprobaremos que la ACL funciona , haciendo pings entre las maquinas.</p><p>Desde PC7 vemos que no nos permite salir del router de licántropos , este nos corta la comunicación pero sin embargo podemos llegar a las demás redes :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.035.jpeg></p><p>Desde PC5 podemos observar el mismo resultado :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.036.jpeg></p><p>Desde PC1 vemos que no obtenemos respuesta ya que solo estamos cortando el trafico de salida impidiendo que las maquinas de “dentro” se comuniquen con las de fuera .</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.037.png></p><p><strong>HUMANOS tampoco podrán comunicarse con el resto de especies</strong></p><p>Con el esquema actual de ACLs no seria necesario implementar una nueva regla en ya que con el esquema actual no es posible la comunicación con ellos . Aunque los mensajes que PC1 realice lleguen a su destino este no recibirá ninguna respuesta .</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.038.png></p><p>Pero si aun así queremos impedir que los humanos puedan enviar mensajes a los demás desde su red implementaremos la siguiente regla en su router :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.039.png></p><p>Ahora estamos cortando los mensajes de los humanos desde el Router 1:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.040.jpeg></p><h2 id=6servidor-dhcp>6.Servidor DHCP</h2><p>Al final decides hacer negocio con las especies raras porque no tienen ni pajolera idea de informática y eres contratado por estos entes malignos para que lleves a cabo las siguientes tareas:</p><p><strong>Hombres lobo</strong></p><p>Los hombres lobo que son bastante burros metiendo direcciones IP a sus máquinas, te piden que les configures el servicio DHCP para que todas sus máquinas reciban automáticamente una IP libre:</p><p>Tendremos que hacer los siguientes pasos :</p><ol><li>El comando ip dhcp excluded-address 192.168.7.1 –> Señalamos las direcciones que no queremos que se repartan por DHCP , es decir las exclusiones .</li><li>El comando ip dhcp pool HOMBRES_LOBO nombramos al rango de direcciones que estamos repartiendo</li><li>Nos meterá a la configuración del rango, ahora le decimos la red que queremos que reparta las direcciones network 192.168.7.0 255.255.255.0</li><li>Ahora le indicaremos que puerta de enlace queremos que asigne default-router 192.168.7.1</li><li>Si quisiéramos configurar un servidor DNS , por ejemplo el de google seria así dns-server 8.8.8.8</li></ol><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.041.png></p><p>Podemos ver que el servidor DHCP esta funcionando correctamente con los parámetros que le hemos indicado anteriormente :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.042.png></p><p><strong>Licántropos</strong></p><p>Los licántropos por su parte, te contratan para que les asignes también por DHCP sus IPs, pero te indican que no pueden recibir las primeras 10 direcciones de su rango (sin contar la de red ni la de la puerta de enlace), ya que éstas, están reservadas para los jefes de su clan que están de viaje y volverán en unos días.</p><p>Declaramos las ips que vamos a excluir :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.043.png></p><p>Nombramos al rango de direcciones que estamos repartiendo para así poder configurarlo:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.044.png></p><p>Le decimos la red que queremos que reparta las direcciones :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.045.png></p><p>Ahora le indicaremos que puerta de enlace queremos que asigne :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.046.png></p><p>Comprobaremos que el servidor dhcp esta funcionando :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.047.png></p><h2 id=7modificación-acls>7.Modificación ACLs</h2><p><strong>Permitir ligar con las vampiros</strong></p><p>De tanto hacer negocio con los vampiros, te fijas en un par de vampiritas que están de muy buen ver y te gustaría poder enviarles mensajitos desde el chalet que te acabas de comprar en HUMANLAND con el pastizal que les estás sacando a las pobres “criaturicas”. Tu IP es la 192.168.1.4 y la de SELENE y SONJA son la 192.168.3.4 y 192.168.3.5 respectivamente. Añade una máquina a HUMANLAND para tu equipo denominado IT KNIGHT y 2 máquinas denominadas SELENE y SONJA con las mencionadas IPs en TRANSILVANIA.</p><p>Si queremos realizar esto deberemos de configurar ACLs avanzadas para poder controlar el origen y el destino de los paquetes.</p><p>La sintaxis es bastante sencilla en este caso :</p><p>permit ip IP_ORIGEN WILDCARD IP_DESTINO WILDCARD Crearemos la ACL para los humanos :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.048.png></p><p>También crearemos la ACL para los vampiros :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.049.png></p><p>La aplicaremos a la interfaz de entrada en cada red , ambas son la FastEthernet 0/0 :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.050.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.051.png></p><p>*****Deberemos de haber quitado anteriormente las lista asignada a la interfaz si no dará un error , para quitarla es el mismo comando que para ponerla poniendo un no delante .</p><p>Ahora comprobaremos la efectividad de estas reglas que hemos implementado :</p><p><strong>IT KNIGHT –> SELENE y SONJA</strong></p><p>Vemos que solo nos permite el trafico hacia estos dos host específicos tal y como hemos indicado en nuestras ACLs</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.052.jpeg></p><p><strong>SELENE –> IT KNIGHT</strong></p><p>Vemos que solo nos permite el trafico hacia estos dos host específicos tal y como hemos indicado en nuestras ACLs , si intentamos comunicarnos con otro host cortara el trafico la ACL:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.053.png></p><p><strong>SONJA–> IT KNIGHT</strong></p><p>Vemos que solo nos permite el trafico hacia estos dos host específicos tal y como hemos indicado en nuestras ACLs , si intentamos comunicarnos con otro host cortara el trafico la ACL:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.054.png></p><p>También podemos ver las estadísticas de la ACL en el router fijándonos en los hits de la regla para ver si están funcionando :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.055.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.056.png></p><p>Aunque en ninguna de las listas hemos especificado en deny any , no seria necesario ya que esta implícito , es decir por defecto al no cumplirse ninguna regla desechara el trafico .</p><h2 id=8-servidor-web>8. Servidor web</h2><p>Desde que no se puede ligar en UNDERWORLD, están todos más aburridos que un ajo, así que decides ponerles un servidor WEB interno a UNDERWORLD. Añade al router PUENTE 1, un servidor denominado FICHEROS que tendrá la IP 192.168.8.2/24, creando las ACLs necesarias para que la comunidad entera de UNDERWORLD, pueda entretenerse viendo algunas web chulas.</p><p>Lo primero sera configurar la nueva interfaz del router de los HUMANOS:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.057.png></p><p>Lo siguiente sera configurar para nuestro esquema actual en el router de VAMPIROS la ruta a la nueva red para que se route el escenario correctamente :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.058.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.059.png></p><p>Ya por ultimo configuraremos la ip de nuestro debian de forma estática con la dirección 192.168.8.2:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.060.png></p><p>Además le instalaremos apache (deberemos hacerlo previamente conectado a la nube NAT ) :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.061.png></p><p>Una vez ya tenemos el servidor web preparado y enrutado en nuestro escenario , vamos a modificar las distintas ACLs para que solo puedan llegar al servidor web por el puerto 80 .</p><p>En el router de los humanos añadimos la siguiente regla , la cual permite todo el trafico hacia el host 192.168.8.2 que vaya al puerto 80:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.062.png></p><p>Para refrescar la lista y que se apliquen los cambios deberemos de volver a asignársela al router :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.063.png></p><p>Ahora haremos lo mismo con el router de los vampiros ya que tiene configuradas ACLs extendidas al igual que los humanos :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.064.png></p><p>Ahora vamos a configurar una ACL avanzada para los licántropos y los hombres lobo :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.065.png></p><p>Vamos a comprobar que NO podemos hacerle ping al servidor desde los VPCs:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.066.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.067.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.068.png></p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.069.png></p><p>En resumen hemos mantenido las reglas anteriores pero hemos permitido el trafico al servidor web siempre y cuando venga por el puerto 80 , por eso no podemos hacerle ping .</p><p>Vamos a comprobar que podemos acceder al servidor web desde las redes : –>HUMANOS :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.070.jpeg></p><p>–>VAMPIROS:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.071.jpeg></p><p>–>LICÁNTROPOS:</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.072.jpeg></p><p>–> HOMBRES LOBO :</p><p><img src=../images/Aspose.Words.0cb93ef6-f4fa-4538-a812-68ecd45de766.073.jpeg></p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Compartir en:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2funderworld%2funderworld%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2funderworld%2funderworld%2f&text=Underworld&via=Atlas" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2funderworld%2funderworld%2f&title=Underworld" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2funderworld%2funderworld%2f&title=Underworld" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Underworld https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2funderworld%2funderworld%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=Underworld&body=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2funderworld%2funderworld%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/javierasping/sentinel/edit/main/content/posts/redes/underworld/underworld.md title="Mejorar esta página" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Mejorar esta página</a></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn data-toggle=tooltip data-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Contenido</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#introducción>Introducción</a></li><li><a href=#1enturar-el-escenario>1.Enturar el escenario</a><ul><li><a href=#tablas-de-enrutamiento-a-papel>Tablas de enrutamiento a “papel”</a></li></ul></li><li><a href=#2configuración-direcciones-ips-interfaces>2.Configuración direcciones Ips interfaces</a><ul><li><a href=#router-humanos>Router humanos</a></li><li><a href=#router-vampiros>Router vampiros</a></li><li><a href=#router-licántropos>Router licántropos</a></li><li><a href=#router-vampiros-1>Router vampiros</a></li></ul></li><li><a href=#3-añadiendo-la-tabla-de-enrutamiento-a-los-routers>3. Añadiendo la tabla de enrutamiento a los routers</a><ul><li><a href=#router-humanos-1>Router humanos</a></li><li><a href=#router-vampiros-2>Router vampiros</a></li><li><a href=#router-licántropos-1>Router licántropos</a></li><li><a href=#router-hombres-lobo>Router hombres lobo</a></li></ul></li><li><a href=#4prueba-de-enrutamiento>4.Prueba de enrutamiento</a></li><li><a href=#5configuración-acls>5.Configuración ACLs</a></li><li><a href=#6servidor-dhcp>6.Servidor DHCP</a></li><li><a href=#7modificación-acls>7.Modificación ACLs</a></li><li><a href=#8-servidor-web>8. Servidor web</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navegación</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#about>Sobre mi</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#skills>Competencias</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#education>Educación</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#accomplishments>Certificaciones</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contacto</h5><ul><li><a href=mailto:contacto@javiercd.es target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>contacto@javiercd.es</span></a></li><li><a href=https://github.com/javierasping target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>javierasping</span></a></li><li><a href=https://www.linkedin.com/in/javiercd target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Francisco Javier Cruces Doval</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Aviso de responsabilidad:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Funcionando con
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.dea0fa56056ee46d1efb2656a664d564d08415d549fdb4c57120e1c852d49c19.js integrity="sha256-3qD6VgVu5G0e+yZWpmTVZNCEFdVJ/bTFcSDhyFLUnBk=" defer></script></body></html>