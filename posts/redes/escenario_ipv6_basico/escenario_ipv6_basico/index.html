<!doctype html><html lang=es><head><title>Escenario IPv6 Básico</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.b392e69d247f872178b69e86e7627c960e9a0d509201625e12d22a4cedf7032b.css integrity="sha256-s5LmnSR/hyF4tp6G52J8lg6aDVCSAWJeEtIqTO33Ays="><link rel=icon type=image/png href=/images/site/avatar_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_q75_box.jpg><meta property="og:title" content="Escenario IPv6 Básico"><meta property="og:description" content="Escenario básico en el cual aprenderemos lo básico sobre el protocolo IPV6"><meta property="og:type" content="article"><meta property="og:url" content="https://www.javiercd.es/posts/redes/escenario_ipv6_basico/escenario_ipv6_basico/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-10-08T10:00:00+00:00"><meta property="article:modified_time" content="2023-10-08T10:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Escenario IPv6 Básico"><meta name=twitter:description content="Escenario básico en el cual aprenderemos lo básico sobre el protocolo IPV6"><meta name=description content="Escenario básico en el cual aprenderemos lo básico sobre el protocolo IPV6"><script>theme=localStorage.getItem("darkmode:color-scheme")||"system",theme=="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png id=logo alt=Logo>
Atlas</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-toggle=collapse data-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ml-auto"><li class=nav-item><a class=nav-link href=/#home>Inicio</a></li><li class=nav-item><a class=nav-link href=/#about>Sobre mi</a></li><li class=nav-item><a class=nav-link href=/#skills>Competencias</a></li><li class=nav-item><a class=nav-link href=/#education>Educación</a></li><li class=nav-item><a class=nav-link href=/#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=nav-link href=/#accomplishments>Certificaciones</a></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Búsqueda data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/posts/iaw/> Aplicaciones webs</a><ul><li><a class=list-link href=/posts/iaw/lamp/ title="Instalación pila LAMP">Instalación pila LAMP</a></li><li><a class=list-link href=/posts/iaw/lemp/ title="Instalación pila LEMP">Instalación pila LEMP</a></li><li><a class=list-link href=/posts/iaw/wordpress/ title="Wordpress LAMP">Wordpress LAMP</a></li><li><a class=list-link href=/posts/iaw/wordpress_lemp/ title="Wordpress LEMP">Wordpress LEMP</a></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/redes/> Redes</a><ul class=active><li><a class=list-link href=/posts/redes/comandos_de_supervision_de_redes/ title="Comandos de supervisión de redes">Comandos de supervisión de redes</a></li><li><a class=list-link href=/posts/redes/switches_gns3/ title="Configuración de switches en GNS3">Configuración de switches en GNS3</a></li><li><a class=list-link href=/posts/redes/enroutamiento_openstack/ title="Enrutamiento en OpenStack">Enrutamiento en OpenStack</a></li><li><a class="active list-link" href=/posts/redes/escenario_ipv6_basico/ title="Escenario IPv6 Básico">Escenario IPv6 Básico</a></li><li><a class=list-link href=/posts/redes/instalacion_wireshark_gns3/ title="Instalacion GNS y Wireshark">Instalacion GNS y Wireshark</a></li><li><a class=list-link href=/posts/redes/configuracion_de_nat/ title="NAT en Cisco y Linux">NAT en Cisco y Linux</a></li><li><a class=list-link href=/posts/redes/arp/ title="Protocolo ARP">Protocolo ARP</a></li><li><a class=list-link href=/posts/redes/tuneles_ipv6/ title="Túneles IPV6">Túneles IPV6</a></li><li><a class=list-link href=/posts/redes/underworld/ title=Underworld>Underworld</a></li><li><a class=list-link href=/posts/redes/underworld_evolution/ title="Underworld evolution">Underworld evolution</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/> Servicios</a><ul><li><a class=list-link href=/posts/servicios/apache/ title=Apache>Apache</a></li><li><a class=list-link href=/posts/servicios/dhcp/ title=DHCP>DHCP</a></li><li><a class=list-link href=/posts/servicios/dns/ title=DNS>DNS</a></li><li><a class=list-link href=/posts/servicios/ftp/ title=FTP>FTP</a></li><li><a class=list-link href=/posts/servicios/nat_iptables/ title="NAT con iptables">NAT con iptables</a></li><li><a class=list-link href=/posts/servicios/ssh/ title=SSH>SSH</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/sistemas/> Sistemas</a><ul><li><a class=list-link href=/posts/sistemas/ad_ubuntu/ title="Active Directory en Ubuntu">Active Directory en Ubuntu</a></li><li><a class=list-link href=/posts/sistemas/comparticion_de_directorios_en_windows/ title="Compartir recursos en Windows">Compartir recursos en Windows</a></li><li><a class=list-link href=/posts/sistemas/nvidia/ title="Drivers Nvidia">Drivers Nvidia</a></li><li><a class=list-link href=/posts/sistemas/empaquetadores_compresores/ title="Empaquetadores y compresores">Empaquetadores y compresores</a></li><li><a class=list-link href=/posts/sistemas/samba_debian/ title="Instalar y configurar samba en Debian">Instalar y configurar samba en Debian</a></li><li><a class=list-link href=/posts/sistemas/nfs_debian/ title="NFS en Debian">NFS en Debian</a></li><li><a class=list-link href=/posts/sistemas/comandos_procesos/ title="Procesos en Linux">Procesos en Linux</a></li><li><a class=list-link href=/posts/sistemas/programacion_tareas/ title="Programación de tareas">Programación de tareas</a></li><li><a class=list-link href=/posts/sistemas/ssh_windows/ title="Servicio ssh en Windows">Servicio ssh en Windows</a></li><li><a class=list-link href=/posts/sistemas/migracion_sistema_de_ficheros/ title="Sistema de ficheros">Sistema de ficheros</a></li><li><a class=list-link href=/posts/sistemas/almacenamiento_servidor_independiente/ title="Storage Spaces en Windows Server">Storage Spaces en Windows Server</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/redes/escenario_ipv6_basico/portada.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hud72a20250efce9adf5aa46631dba75d3_2990_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Francisco Javier Cruces Doval</h5><p class=text-muted>domingo, 8 de octubre de 2023 | 14 minutos</p></div><div class=title><h1>Escenario IPv6 Básico</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/redes/ class="btn btn-sm btn-info">Redes</a></li><li class=rounded><a href=/tags/enrutamiento/ class="btn btn-sm btn-info">Enrutamiento</a></li><li class=rounded><a href=/tags/ipv6/ class="btn btn-sm btn-info">IPV6</a></li></ul></div><div class=post-content id=post-content><p>A lo largo de esta guía, exploraremos la configuración de un escenario básico utilizando redes IPv6 tanto en sistemas Linux como en dispositivos Cisco. Además, abordaremos la configuración de un servidor Apache aprovechando las capacidades de IPv6.</p><h2 id=linux-autoconfiguración-ipv6>Linux Autoconfiguración IPV6</h2><p>Conecta dos máquinas Linux al mismo switch y comprueba que tienen conectividad con IPv6 usando la dirección de enlace local.</p><p>Comprobaremos las IPV6 que tienen los distintos pcs . El PC1 tiene –> fe80::ef7:42ff:fe92:0/64</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.001.png></p><p>Mientras que el PC2 tiene –> fe80::e5f:61ff:feee:0/64</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.002.png></p><p>Estas dos direcciones se denominan de enlace local y se asignan automáticamente a cada interfaz de red . Este tipo solo nos permitirá comunicarnos con los dispositivos de nuestra red local y tienen el prefijo –> FE80::/10</p><p>Si hacemos un ping desde uno de estos a otros con la dirección de enlace local podremos comunicarnos :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.003.png></p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.004.png></p><h3 id=slaac>SLAAC</h3><p>Añade a la misma red una tercera máquina Linux y configúrala como router de forma que dé direcciones IPv6 globales a las otras dos usando SLAAC. No olvides instalar RADVD. Comprueba que tienen conectividad.</p><p>Lo primero que haremos sera configurar la interfaz de red por ipv6 de nuestro router en este caso le asignare el prefijo 3333:db7::</p><p>Calculamos la parte fija de nuestra dirección :</p><p>R1 –> 0c:01:30:a0:00:00 –> 0c:01:30:ff:fe:a0:00:00 –> 0E:01:30:FF:FE:A0:00:00</p><p>Editamos el interfaces y aplicamos la configuración de nuestra tarjeta de red :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.005.png></p><p>Reiniciamos al servicio y tendríamos una direccion global :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.006.png></p><p>SLAAC(Stateless Address Autoconfiuration) es un mecanismo de configuración único para IPV6 no existe un equivalente en IPV4. El cual nos permite que los nodos de nuestra red se configuren automáticamente .</p><p>A partir de la dirección de enlace local que tienen todos los host , mediante el protocolo neighbour discovery solicita si hay algún router dentro de la red local le facilite los parámetros de configuración de la red</p><p>Lo primero que haremos para configurar SLAAC sera instalar el paquete radvd :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.007.png></p><p>Si miramos el estado del demonio este nos dirá que no encuentra su fichero de configuración :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.008.png></p><p>Así que le generaremos uno indicándole la interfaz que va a repartir direcciones y además le diremos el comportamiento que tendrá en nuestra red :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.009.png></p><ul><li><p><strong>MinRtrAdvInterval :</strong> Indica el tiempo mínimo en segundos por el cual el router mandara un mensaje en segundos .</p></li><li><p><strong>MaxRtrAdvInterval:</strong> Indica el tiempo máximo en segundo por el cual el router mandara un mensaje .</p></li><li><p><strong>AdvSendAdvert:</strong> Indica si por la interfaz se mandaran avisos o no .</p></li><li><p><strong>AdvManagedFlag:</strong> Indica si queremos que el servicio utilice DHCPv6(on) o no (off) .</p></li><li><p><strong>Prefix:</strong> Indica el prefijo de red que usara SLAAC para asignar direcciones .</p></li><li><p><strong>AdvValidLifetime:</strong> Indica el tiempo en segundos que una dirección IPV6 sera valida.</p></li><li><p><strong>AdvPreferredLifetime:</strong> Indica el tiempo en segundos que una dirección generada a partir del prefijo sera preferida en lugar de otras direcciones .</p></li></ul><p>Una vez hecho esto reiniciamos el servicio y el demonio comenzara a configurar a nuestros clientes :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.010.jpeg></p><p>Además deberemos de configurar el bit de forwarding para ipv6 en nuestro router , al igual que con ipv4 editamos el archivo /etc/sysctl.conf :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.011.png></p><h4 id=mensajes-de-slaac>Mensajes de SLAAC</h4><p>Podemos ver como se ha configurado el PC1 usando SLAAC :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.012.jpeg></p><p>También el PC2 se ha configurado :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.013.jpeg></p><p>Vamos a estudiar los mensajes que han intervenido en esta configuración de SLAAC , si los numeramos como en esta captura de Wireshark :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.014.png></p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.015.png></p><ul><li><strong>Router solicitation</strong> (RS) (No aparece en la captura) : El PC le envía un mensaje de RS a todos los routers para indicar que necesita un RA , este mensaje se envía si no recibe ningún RA pasado un tiempo.</li><li><strong>Router Advertisement</strong> (RA): Una vez el router recibe el RS o periódicamente envía un RA en el cual se incluye el prefijo de la red y su longitud . El mensaje RA se envía a la dirección IPv6 de multidifusión de todos los nodos, FF02::1, con la dirección link-local del router como la dirección IPv6 de origen. (N0 6 y 12).</li><li><strong>Multicast Listener Report Message v2</strong>:Indica que el dispositivo x ha iniciado una sesión de escucha para trafico multicast (No 7 y 9).</li><li><strong>Neighbor Solicitation</strong> (NS): Se utiliza para conocer la dirección MAC de un dispositivo de tu red , es similar al protocolo ARP .(No 10,11,613).</li><li><strong>Neighbor Advertisement</strong> (NA) : Es el mensaje de respuesta de un NS (No 614).</li></ul><p>Una vez que el cliente a recibido un RA , este procede a configurar su dirección IPV6 , con un prefijo de red de 64 bits pero necesita una IID(Interface Identifier) .</p><p>Hay dos maneras en las que los clientes pueden crear su propia IID única:</p><ul><li><strong>EUI-64:</strong> mediante el proceso EUI-64, la PC1 crea una IID utilizando su dirección MAC de 48 bits.</li><li><strong>De generación aleatoria:</strong> la IID de 64 bits puede ser un número aleatorio generado por el sistema operativo cliente.</li></ul><p>Dado que SLAAC es un proceso sin estado, para que los clientes pueda utilizar esta dirección IPv6 creada recientemente, debe verificar que sea única. El cliente enviara un NS con su propia dirección como la dirección IPv6 de destino. Si ningún otro dispositivo responde con un mensaje de anuncio de vecino, la dirección es única y puede ser utilizada por el cliente. Si este recibe un NA, la dirección no es única, y el sistema operativo debe determinar una nueva ID de interfaz para utilizar.</p><p>Este proceso forma parte de la detección de vecinos ICMPv6 y se conoce como “detección de direcciones duplicadas (DAD)”.</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.016.png></p><p>Esta imagen explica la configuración de una interfaz por SLAAC. Ahora vamos a comprobar que los distintos clientes tienen conectividad entre si :</p><p>PC1 –> 3333:db7::ef7:42ff:fe92:0
PC2 –> 3333:db7::e5f:61ff:feee:0<br>R1 –> 3333:db7::e01:30ff:fea0:0</p><p>Router 1 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.017.png></p><p>PC2:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.018.png></p><p>Tenemos que tener en cuenta que estas “concesiones” de direcciones no se almacenan en ningún sitio , es decir en el servidor no almacenamos las configuraciones que ha realizado el servicio .</p><h4 id=dhcpv6-con-slaac>DHCPv6 con SLAAC</h4><p>Cambia la configuración para que utilice DHCPv6 en vez de SLAAC enviando también los servidores DNS. Comprueba que las máquinas tienen conectividad.</p><p>Para ello nos instalamos el servidor DHCPv6 , el paquete es el mismo para ipv4 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.019.png></p><p>Editamos el fichero de configuración para IPV6 –> sudo nano /etc/dhcp/dhcpd6.conf:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.020.png></p><p>En el fichero /etc/default/isc-dhcp-server indicaremos no solo la interfaz que queremos repartir direcciones si no también especificaremos que el servidor funcionara por IPV6 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.021.jpeg></p><p>Reiniciamos el servicio y comprobamos que esta funcionando con los parámetros que le hemos asignado en la configuraron :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.022.jpeg></p><p>Vamos a comprobar que los clientes se configuraran usando ipv6 , para ello la configuración en el network interfaces es bastante similar a IPV4 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.023.png></p><p>Reiniciamos el servicio networking.service y obtendremos la configuración por DHCP en la tarjeta :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.024.png></p><p>Además también podemos ver las concesiones el fichero de concesiones , en el servidor en la siguiente ruta /var/lib/dhcp/dhcpd6.leases :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.025.jpeg></p><p>No lo he mencionado anteriormente pero para que al producirse la configuración el cliente obtenga los parámetros que hemos configurado por DHCPv6 tendremos que poner este parámetro a ON en el fichero de configuración de SLAAC :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.026.png></p><p>Como podemos ver el único parámetro que hemos especificado en el servidor DHCP a sido el DNS de google ha sido correctamente configurado en nuestro cliente :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.027.png></p><h5 id=mensajes-dhcpv6-con-slaac>Mensajes DHCPv6 con SLAAC</h5><p>Acabamos de configurar SLAAC y DHCPv6 sin estado , esto significa que :</p><ul><li>Usa SLAAC para obtener una dirección IPV6 de tipo global unicast , además de la puerta de enlace .</li><li>Usa el servidor DHCPv6 sin estado, para el resto de parámetros de configuración de nuestra red .</li></ul><p>Es decir hemos configurado la segunda opción de la siguiente imagen :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.028.jpeg></p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.029.jpeg></p><div class="alert info"><span><i data-feather=info></i></span>
<span><strong>Las capturas que verás a continuación NO están recortadas debido a que se ven pixeladas. Los mensajes de la comunicación están en orden.</strong></span></div><p>Si observamos la captura de Wireshark y la comparamos con la configuración única de SLAAC :</p><p><strong>Operaciones de SLAAC:</strong></p><ol><li>Podemos ver que el PC1 a solicitado un RS , a todos los routers de la red (Multicast)</li></ol><p><img alt=ref1 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.030.png></p><ol start=2><li>R1 le responde a PC1 con un RA(Indica si necesitara comunicarse con un DHCPv6 con estado o sin estado)</li></ol><p><img alt=ref2 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.031.png></p><ol start=3><li>NS , para comprobar que la dirección asignada no esta duplicada</li></ol><p><img alt=ref3 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.032.png></p><p><strong>Operaciones de DHCPv6:</strong></p><ol start=4><li>Solicit a todos los servidores DHCPv6 de la red (Multicast a ff02::1:2) incluye un identificador de cliente CID.<img alt=ref1 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.030.png></li><li>Advertise : Es la respuesta del servidor DHCPv6 a un solicit , este incluye las opciones de configuración oportunos , incluido una IPv6 . También incluye un CID y un XID(Id transacción).<img alt=ref4 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.033.png></li><li>Request: El cliente envía este mensaje a todos los servidores DHCPv6 para indicar que desea los parámetros ofertados en el Adverstise . También incluyen CID y XID.<img alt=ref5 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.034.png></li><li>Reply: El servidor DHCPv6 responde y confirma que la dirección ha sido asignada así como todos los parámetros adicionales de configuración .También incluyen CID y XID.<img alt=ref1 src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.030.png></li></ol><p>Aquí te dejo una imagen en la que se observa el orden de los mensajes que hemos recibido y una breve descripción del mismo , además nos indica si los mensajes son unicast o multicast :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.035.jpeg></p><h2 id=apache-en-ipv6>Apache en IPV6</h2><p>Para las versiones de Apache superiores a 2.X tienen soporte para IPV6 habilitado por defecto así que al instalar el servicio ya estaremos escuchando por este protocolo sin necesidad de realizar ninguna configuración adicional en el servicio .</p><p>Podemos comprobar si al instalarlo nuestro servidor esta escuchando por ese puerto :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.036.png></p><p>En el caso de que creemos un virtualhost podemos especificar como queremos que trabajen si usando ambos protocolos IPV6 y IPV4 o solo uno de ellos . Vemos que ssh también utiliza ipv6 por defecto .</p><h3 id=acceso-al-servidor-web-desde-dentro-de-la-red>Acceso al servidor web desde dentro de la red</h3><p>Vamos a acceder desde las maquinas de nuestra red en mi caso lo he montado en el router ya que es el único que tiene acceso a internet en este escenario .</p><p>Me conectare a el utilizando la direccion global pero podríamos usar la local sin problema ya que pertenecemos a la misma red local .</p><p>Acceso desde PC2:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.037.png></p><h3 id=acceso-al-servidor-web-desde-fuera-de-la-red>Acceso al servidor web desde fuera de la red</h3><p>Para esto deberemos de configurar R1 y ‘PC3’ en la misma red usando IPV6 :</p><p>PC3:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.038.png></p><p>R1:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.039.png></p><p>Le haremos la petición a PC1 desde PC3 que esta fuera de esa red local , como vemos no es necesario hacer NAT .</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.040.jpeg></p><p>Incluso puedo hacerle ping a un host desde otra red :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.041.png>Si analizamos estas peticiones con Wireshark podemos ver que en ningún momento se produce NAT:</p><p>Fuera de la red :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.042.png></p><p>Dentro de la red:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.043.png></p><p>Por supuesto un host de nuestra red local puede acceder al servidor web :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.044.png></p><h2 id=cisco>CISCO</h2><h3 id=configuración-de-un-router-cisco-en-ipv6>Configuración de un router cisco en IPV6</h3><p>Lo primero que haremos sera calcular la direccion IPV6 que le corresponden a las MACS :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.045.png></p><p>F 0/0 –> CA:01:6C:FA:00:00 –> CA:01:6C:FF:FE:FA:00:00 –> C801:6CFF:FEFA:0</p><p>F 1/0 –> CA:01:6C:FA:00:1C-→ CA:01:6C:FF:FE:FA:00:1C –> C801:6CFF:FEFA:001C</p><p>Para que nuestro router se configure usando SLACC y no tengamos que hacer esto manualmente introduciremos los siguientes comandos para cada una de las interfaces que queramos que se configuren por SLAAC :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.046.png></p><p>También deberemos de indicarle no shut para que se levante la interfaz .</p><p>Con el siguiente comando comprobaremos que nuestro router se ha configurado correctamente automáticamente usando SLAAC :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.047.png></p><p>Ya con las direcciones de enlace local tendremos conectividad con el router :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.048.png></p><h4 id=slaac-1>SLAAC</h4><p>Ahora vamos a hacer que el router configure a los clientes usando SLAAC .</p><p>Vamos a configurar una dirección global a nuestro router en la interfaz que da a la red que queremos darle este servicio , con el prefijo de red : 3333:db7::</p><p>Vamos a utilizar EUI-64 para configurar nuestras interfaces :</p><p>FastEthernet 0/0 –> 3333::C801:6CFF:FEFA:0/64</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.049.png></p><p>FastEthernet 1/0 –> 2222::C801:6CFF:FEFA:1C/64</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.050.png></p><p>Comprobamos las direcciones IPV6 se han “generado” correctamente :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.051.png></p><p>Para que el router nos configure a los clientes deberemos de introducir el siguiente comando este , hará que nuestro router mande RA y conteste a las peticiones de RS:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.052.png></p><p>Una vez hecho esto nuestros clientes se habrán configurado correctamente :</p><p>PC1:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.053.png></p><p>PC2:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.054.png></p><p>Los mensajes que se han producido al configurar los clientes :</p><p><strong>Router solicitation</strong> (RS): El PC le envía un mensaje de RS a todos los routers para indicar que necesita un RA , este mensaje se envía si no recibe ningún RA pasado un tiempo.</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.055.png></p><p><strong>Router Advertisement</strong> (RA): Una vez el router recibe el RS o periódicamente envía un RA en el cual se incluye el prefijo de la red y su longitud . En el caso de que el router responda a un RS este le envía un RA especifico al host que lo ha solicitado . En el caso de que sea un mensaje RA periódico se envía a la dirección IPv6 de multidifusión de todos los nodos, FF02::1, con la dirección link-local del router como la dirección IPv6 de origen.</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.056.png></p><p><strong>Neighbor Solicitation</strong> (NS): Se utiliza para conocer la direccion MAC de un dispositivo de tu red , es similar al protocolo ARP .</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.057.png></p><p><strong>Neighbor Advertisement</strong> (NA) : Es el mensaje de respuesta de un NS .</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.058.png></p><h5 id=dhcpv6-con-slaac-1>DHCPv6 con SLAAC</h5><p>Configurar un servidor de DHCPv6 con estado es similar a configurar un servidor sin estado. La diferencia más importante es que un servidor con estado también incluye información de direccionamiento IPv6 de manera similar a un servidor DHCPv4.</p><p>Lo primero que tendremos que hacer sera para habilitar el routing IPv6. Este comando no es necesario para que el router sea un servidor de DHCPv6 con estado, pero se requiere para que el router origine los mensajes RA ICMPv6.</p><p>–> ipv6 unicast-routing</p><p>Lo tenemos configurado en el apartado anterior así que no lo volveremos a hacer . Configuraremos un pool DHCPV6 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.059.png></p><p>Con DHCPv6 con estado, todos los parámetros de direccionamiento y otros parámetros de configuración deben ser asignados por el servidor de DHCPv6. El comando address prefix se utiliza para indicar el conjunto de direcciones que debe asignar el servidor. La opción lifetime indica el tiempo de arrendamiento válido y preferido en segundos. Al igual que con DHCPv6 sin estado, el cliente utiliza la dirección IPv6 de origen del paquete que contenía el mensaje RA.</p><p>Le indicamos el prefijo de red y el tiempo de vida de cada dirección :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.060.png></p><p>Ahora le indicamos los servidores DNS :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.061.png></p><p>Aun podemos configurar mas parámetros como el nombre del dominio pero en mi caso solo me interesa esto , así que procederemos a indicarle en que interfaz tiene que funcionar el servicio :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.062.png></p><p>Ahora comprobaremos que el servidor DHCP , esta funcionado en nuestra interfaz :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.063.png></p><p>Veremos como en el cliente se ha asignado el servido DNS:</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.064.png></p><p>Y la concesión en el servidor DHCP :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.065.png></p><p><strong>Operaciones de SLAAC:</strong></p><ol><li>Podemos ver que el PC2 a solicitado un RS , a todos los routers de la red (Multicast)</li></ol><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.066.png></p><ol start=2><li>R1 le responde a PC1 con un RA(Indica si necesitara comunicarse con un DHCPv6 con estado o sin estado)</li></ol><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.067.png></p><p><strong>Operaciones de DHCPv6:</strong></p><ol start=3><li>Solicit a todos los servidores DHCPv6 de la red (Multicast a ff02::1:2) incluye un identificador de cliente CID.</li></ol><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.068.png></p><ol start=4><li>Advertise : Es la respuesta del servidor DHCPv6 a un solicit , este incluye las opciones de configuración oportunos , incluido una IPv6 . También incluye un CID y un XID(Id transacción).</li></ol><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.069.png></p><ol start=5><li>Request: El cliente envía este mensaje a todos los servidores DHCPv6 para indicar que desea los parámetros ofertados en el Adverstise . También incluyen CID y XID.</li></ol><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.070.png></p><ol start=6><li>Reply: El servidor DHCPv6 responde y confirma que la dirección ha sido asignada así como todos los parámetros adicionales de configuración .También incluyen CID y XID.</li></ol><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.071.png></p><h6 id=acceso-al-servidor-web-desde-dentro-de-la-red-1>Acceso al servidor web desde dentro de la red</h6><p>Desde nuestra red local podremos hacer la petición al servidor web usando tanto la dirección local de enlace como la dirección global :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.072.png></p><h6 id=acceso-al-servidor-web-desde-fuera-de-la-red-1>Acceso al servidor web desde fuera de la red</h6><p>SWEB –> 3333:db7::ef7:42ff:fe92:0</p><p>Vemos que con la configuración anterior que teníamos en apache podemos acceder sin problema al servidor web desde una maquina de fuera de nuestra red :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.073.png></p><h2 id=configuración-básica-de-apache-para-ipv6>Configuración básica de apache para IPV6</h2><p>Como comentaba antes no es necesario a partir de la version 2.X en adelante de configurar nada adicionalmente en apache para que nuestro servidor funcione usando el protocolo IPV6 ya por defecto este escucha en IPV4 y IPV6 .</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.074.png></p><p>Sin embargo podemos configurar para que este solo escuche por IPV6 , para ello deberemos de realizar una simple configuración en el servicio . Accederemos al fichero –> /etc/apache2/ports.conf</p><p>Comentaremos la linea Listen 80 ya que hace referencia a IPV4 y le añadiremos la referente a ipv6.</p><p>Con esta configuración escucharemos todas las peticiones de cualquier dirección IPV6 , en los corchetes podemos especificar una dirección para responderle peticiones solo a esta .</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.075.png></p><p>Ahora accederemos a nuestro host virtual y cambiaremos la declaración de este , al igual que hemos hecho arriba modificando la etiqueta que hace referencia a todas las direcciones IPV4 y la cambiaremos por esta para hacer referencia a todas las direcciones IPV6 por el puerto 80 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.076.png></p><p>Ahora reiniciaremos el servicio apache y comprobaremos que el estado del mismo es exitoso :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.077.jpeg></p><p>Con esto ya nuestro servidor apache funcionaria solo en IPV6 :</p><p><img src=../img/Aspose.Words.e7f0d3c3-3d56-4aa1-a556-ca7031f37ba4.078.png></p><h2 id=bibliografía>Bibliografía</h2><ul><li><a href=https://youtu.be/MndaZaCo6xk target=_blank rel=noopener>¿Que es SLAAC?-Alberto Molina</a></li><li><a href=https://www.sapalomera.cat/moodlecf/RS/2/course/module10/10.2.1.2/10.2.1.2.html target=_blank rel=noopener>Mensajes de SLAAC</a></li><li><a href=https://franciscojesusgu.files.wordpress.com/2020/07/ut01-sri-ipv6_7_dhcp.pdf target=_blank rel=noopener>Montar un servidor DHCPv6 Debian</a></li><li><a href=https://youtu.be/tP9QOLZrAss target=_blank rel=noopener>Mensajes DHCPv6 con SLAAC</a></li><li><a href=http://www.ipv6tf.org/pdf/ipv6paratodos.pdf target=_blank rel=noopener>Apache IPV6</a></li></ul></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Compartir en:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2fescenario_ipv6_basico%2fescenario_ipv6_basico%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2fescenario_ipv6_basico%2fescenario_ipv6_basico%2f&text=Escenario%20IPv6%20B%c3%a1sico&via=Atlas" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2fescenario_ipv6_basico%2fescenario_ipv6_basico%2f&title=Escenario%20IPv6%20B%c3%a1sico" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2fescenario_ipv6_basico%2fescenario_ipv6_basico%2f&title=Escenario%20IPv6%20B%c3%a1sico" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=Escenario%20IPv6%20B%c3%a1sico https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2fescenario_ipv6_basico%2fescenario_ipv6_basico%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=Escenario%20IPv6%20B%c3%a1sico&body=https%3a%2f%2fwww.javiercd.es%2fposts%2fredes%2fescenario_ipv6_basico%2fescenario_ipv6_basico%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/javierasping/sentinel/edit/main/content/posts/redes/escenario_ipv6_basico/escenario_ipv6_basico.md title="Mejorar esta página" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Mejorar esta página</a></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn data-toggle=tooltip data-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Contenido</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#linux-autoconfiguración-ipv6>Linux Autoconfiguración IPV6</a><ul><li><a href=#slaac>SLAAC</a><ul><li><a href=#mensajes-de-slaac>Mensajes de SLAAC</a></li><li><a href=#dhcpv6-con-slaac>DHCPv6 con SLAAC</a><ul><li><a href=#mensajes-dhcpv6-con-slaac>Mensajes DHCPv6 con SLAAC</a></li></ul></li></ul></li></ul></li><li><a href=#apache-en-ipv6>Apache en IPV6</a><ul><li><a href=#acceso-al-servidor-web-desde-dentro-de-la-red>Acceso al servidor web desde dentro de la red</a></li><li><a href=#acceso-al-servidor-web-desde-fuera-de-la-red>Acceso al servidor web desde fuera de la red</a></li></ul></li><li><a href=#cisco>CISCO</a><ul><li><a href=#configuración-de-un-router-cisco-en-ipv6>Configuración de un router cisco en IPV6</a><ul><li><a href=#slaac-1>SLAAC</a><ul><li><a href=#dhcpv6-con-slaac-1>DHCPv6 con SLAAC</a><ul><li><a href=#acceso-al-servidor-web-desde-dentro-de-la-red-1>Acceso al servidor web desde dentro de la red</a></li><li><a href=#acceso-al-servidor-web-desde-fuera-de-la-red-1>Acceso al servidor web desde fuera de la red</a></li></ul></li></ul></li></ul></li></ul></li><li><a href=#configuración-básica-de-apache-para-ipv6>Configuración básica de apache para IPV6</a></li><li><a href=#bibliografía>Bibliografía</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navegación</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#about>Sobre mi</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#skills>Competencias</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#education>Educación</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#accomplishments>Certificaciones</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contacto</h5><ul><li><a href=mailto:contacto@javiercd.es target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>contacto@javiercd.es</span></a></li><li><a href=https://github.com/javierasping target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>javierasping</span></a></li><li><a href=https://www.linkedin.com/in/javiercd target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Francisco Javier Cruces Doval</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Aviso de responsabilidad:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Funcionando con
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.dea0fa56056ee46d1efb2656a664d564d08415d549fdb4c57120e1c852d49c19.js integrity="sha256-3qD6VgVu5G0e+yZWpmTVZNCEFdVJ/bTFcSDhyFLUnBk=" defer></script></body></html>