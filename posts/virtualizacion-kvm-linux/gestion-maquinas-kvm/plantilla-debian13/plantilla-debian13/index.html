<!doctype html><html lang=es><head><title>Cómo crear una plantilla de máquina virtual Debian 13</title><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.ddf4c4775d35e5bc3dd64c797b179f99eaf85cf9811e64bd08f8c44a68d0b229.css integrity="sha256-3fTEd1015bw91kx5exefmer4XPmBHmS9CPjESmjQsik="><link rel=icon type=image/png href=/images/site/avatar_hu_f10227dc088ad43a.jpg><meta property="og:title" content="Atlas"><meta property="og:type" content="website"><meta property="og:description" content="Portafolio y blog personal de Francisco Javier Cruces Doval"><meta property="og:image" content="/images/author/john.png"><meta property="og:url" content="https://www.javiercd.es"><meta name=description content="Guía paso a paso para crear una plantilla (golden image) de Debian 13 con KVM/libvirt: preparación, generalización con virt-sysprep, compactación con virt-sparsify, marcaje de solo lectura y buenas prácticas de clonación."><script async src="https://www.googletagmanager.com/gtag/js?id=G-GVDYVWJLRH"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GVDYVWJLRH")}</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-GVDYVWJLRH"></script><script>var dnt,doNotTrack=!1;if(null&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-GVDYVWJLRH")}</script><script integrity="sha256-DO4ugzEwhTW1Id1UIWn0gUJWaebCYOypeTit6LW4QB4=">let theme=localStorage.getItem("theme-scheme")||localStorage.getItem("darkmode:color-scheme")||"light";theme==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?theme="dark":theme="light"),document.documentElement.setAttribute("data-theme",theme)</script></head><body class="type-posts kind-page" data-bs-spy=scroll data-bs-target=#TableOfContents data-bs-offset=80><div class="container-fluid bg-secondary wrapper"><nav class="navbar navbar-expand-xl top-navbar shadow" id=top-navbar><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<i data-feather=sidebar></i>
</button>
<a class=navbar-brand href=/><img src=/images/site/masthead_hu_f10227dc088ad43a.png id=logo alt=Logo>
Atlas</a>
<button class="navbar-toggler navbar-light" id=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#top-nav-items aria-label=menu>
<i data-feather=menu></i></button><div class="collapse navbar-collapse dynamic-navbar" id=top-nav-items><ul class="nav navbar-nav ms-auto"><li class=nav-item><a class=nav-link href=/#home>Inicio</a></li><li class=nav-item><a class=nav-link href=/#about>Sobre mi</a></li><li class=nav-item><a class=nav-link href=/#skills>Competencias</a></li><li class=nav-item><a class=nav-link href=/#education>Educación</a></li><li class=nav-item><a class=nav-link href=/#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=nav-link href=/#accomplishments>Certificaciones</a></li><div id=top-navbar-divider></div><li class=nav-item><a class=nav-link id=blog-link href=/posts>Posts</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=languageSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><span class="fi fi-es"></span>
Español</a><div class=dropdown-menu aria-labelledby=languageSelector><a class="dropdown-item nav-link languages-item" href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/plantilla-debian13/plantilla-debian13><span class="fi fi-es"></span>
Español
</a><a class="dropdown-item nav-link languages-item" href=/en/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/plantilla-debian13/plantilla-debian13><span class="fi fi-gb"></span>
English</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-bs-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=theme-icon src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=theme-icon src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=theme-icon src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/masthead_hu_f10227dc088ad43a.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/masthead_hu_f10227dc088ad43a.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Búsqueda data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i data-feather=plus-circle></i><a class=list-link href=/posts/iaw/> Aplicaciones webs</a><ul><li><a class=list-link href=/posts/iaw/lamp/ title="Instalación pila LAMP">Instalación pila LAMP</a></li><li><a class=list-link href=/posts/iaw/lemp/ title="Instalación pila LEMP">Instalación pila LEMP</a></li><li><a class=list-link href=/posts/iaw/wordpress/ title="Wordpress LAMP">Wordpress LAMP</a></li><li><a class=list-link href=/posts/iaw/wordpress_lemp/ title="Wordpress LEMP">Wordpress LEMP</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/base_de_datos/> Base de datos</a><ul><li><a class=list-link href=/posts/base_de_datos/acceso_remoto_mariadb/ title="Acceso remoto en MariaDB">Acceso remoto en MariaDB</a></li><li><a class=list-link href=/posts/base_de_datos/oracle_acceso_remoto/ title="Configuración de acceso remoto en Oracle">Configuración de acceso remoto en Oracle</a></li><li><a class=list-link href=/posts/base_de_datos/instalacion_oracle_19c_debian12/ title="Instalación de Oracle 19c bajo Debian 12">Instalación de Oracle 19c bajo Debian 12</a></li><li><a class=list-link href=/posts/base_de_datos/instalar_postgresql/ title="Instalación de PostgreSQL en Debian 12">Instalación de PostgreSQL en Debian 12</a></li><li><a class=list-link href=/posts/base_de_datos/instalar_mariadb/ title="Instalar MariaDB en Debian">Instalar MariaDB en Debian</a></li><li><a class=list-link href=/posts/base_de_datos/interconexion_de_servidores/ title="Interconexión de servidores de bases de datos">Interconexión de servidores de bases de datos</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/ci_cd/> CI/CD Jenkins</a><ul><li><a class=list-link href=/posts/ci_cd/practica_jenkins/ title="Práctica CI/CD con Jenkins">Práctica CI/CD con Jenkins</a></li><li><a class=list-link href=/posts/ci_cd/taller1_jenkins/ title="Taller 1 Corrector ortográfico de documentos markdown (test)">Taller 1 Corrector ortográfico de documentos markdown (test)</a></li><li><a class=list-link href=/posts/ci_cd/taller2_jenkins/ title="Taller 2 Comprobación de HTML5 válido y despliegue en surge.sh (test y deploy)">Taller 2 Comprobación de HTML5 válido y despliegue en surge.sh (test y deploy)</a></li><li><a class=list-link href=/posts/ci_cd/taller3_jenkins/ title="Taller 3 Integración continua de aplicación django (Test)">Taller 3 Integración continua de aplicación django (Test)</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/cortafuegos/> Cortafuegos</a><ul><li><a class=list-link href=/posts/cortafuegos/fortinet_cli/ title="Fortinet CLI">Fortinet CLI</a></li><li><a class=list-link href=/posts/cortafuegos/fortinet_uno/ title="Perimetral con Fortinet I">Perimetral con Fortinet I</a></li><li><a class=list-link href=/posts/cortafuegos/fortinet_dos/ title="Perimetral con Fortinet II">Perimetral con Fortinet II</a></li><li><a class=list-link href=/posts/cortafuegos/nftables_uno/ title="Perimetral con Nftables I">Perimetral con Nftables I</a></li><li><a class=list-link href=/posts/cortafuegos/nftables_dos/ title="Perimetral con Nftables II">Perimetral con Nftables II</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/docker/> Docker</a><ul><li><a class=list-link href=/posts/docker/instalar_docker_compose/ title="Instalación de Docker Compose en Ubuntu 24">Instalación de Docker Compose en Ubuntu 24</a></li><li><a class=list-link href=/posts/docker/instalar_docker_ubuntu24/ title="Instalación de Docker en Ubuntu 24">Instalación de Docker en Ubuntu 24</a></li><li><a class=list-link href=/posts/docker/taller1/ title="Taller 1 Almacenamiento y redes en Docker">Taller 1 Almacenamiento y redes en Docker</a></li><li><a class=list-link href=/posts/docker/taller2/ title="Taller 2 Escenarios multicontenedor en Docker">Taller 2 Escenarios multicontenedor en Docker</a></li><li><a class=list-link href=/posts/docker/taller3/ title="Taller 3 Creación de imágenes Docker">Taller 3 Creación de imágenes Docker</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/drivers/> Drivers Linux</a><ul><li><a class=list-link href=/posts/drivers/nvidia_optimus/ title="Como elegir que gráfica usar en mi portátil con Linux">Como elegir que gráfica usar en mi portátil con Linux</a></li><li><a class=list-link href=/posts/drivers/nvidia_driver/ title="Drivers Nvidia">Drivers Nvidia</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/observabilidad/> Observabilidad</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/observabilidad/metricas/> Métricas</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/observabilidad/metricas/prometheus/> Prometheus</a><ul><li><a class=list-link href=/posts/observabilidad/metricas/prometheus/instalacion_basica_docker_compose/ title="Instalación de Prometheus con docker-compose y Node Exporter en Debian 12">Instalación de Prometheus con docker-compose y Node Exporter en Debian 12</a></li></ul></li></ul></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/redes/> Redes</a><ul><li><a class=list-link href=/posts/redes/android_gns3/ title="Android GNS3-KVM">Android GNS3-KVM</a></li><li><a class=list-link href=/posts/redes/comandos_de_supervision_de_redes/ title="Comandos de supervisión de redes">Comandos de supervisión de redes</a></li><li><a class=list-link href=/posts/redes/switches_gns3/ title="Configuración de switches en GNS3">Configuración de switches en GNS3</a></li><li><a class=list-link href=/posts/redes/enroutamiento_openstack/ title="Enrutamiento en OpenStack">Enrutamiento en OpenStack</a></li><li><a class=list-link href=/posts/redes/escenario_ipv6_basico/ title="Escenario IPv6 Básico">Escenario IPv6 Básico</a></li><li><a class=list-link href=/posts/redes/instalar_gns3_debian12/ title="Instalacion GNS3 en Debian 12">Instalacion GNS3 en Debian 12</a></li><li><a class=list-link href=/posts/redes/instalacion_wireshark_gns3/ title="Instalacion GNS3 y Wireshark">Instalacion GNS3 y Wireshark</a></li><li><a class=list-link href=/posts/redes/configuracion_de_nat/ title="NAT en Cisco y Linux">NAT en Cisco y Linux</a></li><li><a class=list-link href=/posts/redes/arp/ title="Protocolo ARP">Protocolo ARP</a></li><li><a class=list-link href=/posts/redes/tuneles_ipv6/ title="Túneles IPV6">Túneles IPV6</a></li><li><a class=list-link href=/posts/redes/underworld/ title=Underworld>Underworld</a></li><li><a class=list-link href=/posts/redes/underworld_evolution/ title="Underworld evolution">Underworld evolution</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/seguridad/> Seguridad</a><ul><li><a class=list-link href=/posts/seguridad/https_autofirmado/ title=HTTPS>HTTPS</a></li><li><a class=list-link href=/posts/seguridad/forense/ title="Informática forense">Informática forense</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/> Servicios</a><ul><li><a class=list-link href=/posts/servicios/apache/ title=Apache>Apache</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/dhcp/> DHCP</a><ul><li><a class=list-link href=/posts/servicios/dhcp/instalacion_y_configuracion_de_un_servidor_dhcp_en_linux/ title="Instalación y configuración de un servidor DHCP en Linux">Instalación y configuración de un servidor DHCP en Linux</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/dns/> DNS</a><ul><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/dns/bind9/> BIND9</a><ul><li><a class=list-link href=/posts/servicios/dns/bind9/dns_esclavo/ title="Configuring a Slave DNS Server with BIND9">Configuring a Slave DNS Server with BIND9</a></li><li><a class=list-link href=/posts/servicios/dns/bind9/instalacion_basica/ title="Instalación y configuración de BIND9 en Linux">Instalación y configuración de BIND9 en Linux</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/servicios/dns/dnsmasq/> DNSMASQ</a><ul><li><a class=list-link href=/posts/servicios/dns/dnsmasq/instalacion_basica/ title="Servidor local con DNSMasq">Servidor local con DNSMasq</a></li></ul></li></ul></li><li><a class=list-link href=/posts/servicios/ftp/ title=FTP>FTP</a></li><li><a class=list-link href=/posts/servicios/nat_iptables/ title="NAT con iptables">NAT con iptables</a></li><li><a class=list-link href=/posts/servicios/ssh/ title=SSH>SSH</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/sistemas/> Sistemas</a><ul><li><a class=list-link href=/posts/sistemas/ad_ubuntu/ title="Active Directory en Ubuntu">Active Directory en Ubuntu</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/sistemas/comandos_linux/> Comandos en Linux</a><ul><li><a class=list-link href=/posts/sistemas/comandos_linux/ejercicios_de_manejo_de_modulos/ title="Ejercicios de manejo de módulos">Ejercicios de manejo de módulos</a></li><li><a class=list-link href=/posts/sistemas/comandos_linux/ejercicios_de_modificacion_de_parametros_del_kernel/ title="Ejercicios de modificación de parámetros del kernel">Ejercicios de modificación de parámetros del kernel</a></li><li><a class=list-link href=/posts/sistemas/comandos_linux/ejercicios_gestion_de_paqueteria/ title="Ejercicios gestión de paquetería">Ejercicios gestión de paquetería</a></li><li><a class=list-link href=/posts/sistemas/comandos_linux/empaquetadores_compresores/ title="Empaquetadores y compresores">Empaquetadores y compresores</a></li><li><a class=list-link href=/posts/sistemas/comandos_linux/gestion_de_paquetes/ title="Gestión de paquetes">Gestión de paquetes</a></li><li><a class=list-link href=/posts/sistemas/comandos_linux/comandos_procesos/ title="Procesos en Linux">Procesos en Linux</a></li><li><a class=list-link href=/posts/sistemas/comandos_linux/programacion_tareas/ title="Programación de tareas">Programación de tareas</a></li></ul></li><li><a class=list-link href=/posts/sistemas/comparticion_de_directorios_en_windows/ title="Compartir recursos en Windows">Compartir recursos en Windows</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/sistemas/compilaciones_linux/> Compilaciones en Linnux</a><ul><li><a class=list-link href=/posts/sistemas/compilaciones_linux/compilacion_de_un_kernel/ title="Compilación de un kernel">Compilación de un kernel</a></li><li><a class=list-link href=/posts/sistemas/compilaciones_linux/compilacion_de_un_programa_en_c_utilizando_un_makefile/ title="Compilación de un programa en C utilizando un Makefile">Compilación de un programa en C utilizando un Makefile</a></li></ul></li><li><a class=list-link href=/posts/sistemas/activacion_selinux/ title="Configuración activación de SELinux">Configuración activación de SELinux</a></li><li><a class=list-link href=/posts/sistemas/creacion_de_un_sistema_automatizado_de_instalacion/ title="Creación de un sistema automatizado de instalación">Creación de un sistema automatizado de instalación</a></li><li><a class=list-link href=/posts/sistemas/samba_debian/ title="Instalar y configurar samba en Debian">Instalar y configurar samba en Debian</a></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/sistemas/migraciones/> Migraciones en Linnux</a><ul><li><a class=list-link href=/posts/sistemas/migraciones/eliminacion_systemd/ title="Eliminación de systemd">Eliminación de systemd</a></li><li><a class=list-link href=/posts/sistemas/migraciones/paso_de_centos_stream_8_a_centos_stream_9/ title="Paso de CentOS stream 8 a CentOS stream 9">Paso de CentOS stream 8 a CentOS stream 9</a></li><li><a class=list-link href=/posts/sistemas/migraciones/migracion_sistema_de_ficheros/ title="Sistema de ficheros">Sistema de ficheros</a></li><li><a class=list-link href=/posts/sistemas/migraciones/transformacion_instancia_cloud/ title="Transformación instancia cloud">Transformación instancia cloud</a></li></ul></li><li><a class=list-link href=/posts/sistemas/nfs_debian/ title="NFS en Debian">NFS en Debian</a></li><li><a class=list-link href=/posts/sistemas/recoleccion_logs_journald/ title="Recolección centralizada de logs journald">Recolección centralizada de logs journald</a></li><li><a class=list-link href=/posts/sistemas/ssh_windows/ title="Servicio ssh en Windows">Servicio ssh en Windows</a></li><li><a class=list-link href=/posts/sistemas/almacenamiento_servidor_independiente/ title="Storage Spaces en Windows Server">Storage Spaces en Windows Server</a></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/virtualizacion-kvm-linux/> Virtualización KVM en Linux</a><ul class=active><li><i data-feather=plus-circle></i><a class=list-link href=/posts/virtualizacion-kvm-linux/introduccion-kvm/> Introducción a la virtualización con KVM</a><ul><li><a class=list-link href=/posts/virtualizacion-kvm-linux/introduccion-kvm/conceptos-virtualizacion/ title="Conceptos de virtualización">Conceptos de virtualización</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/introduccion-kvm/tipo-hipervisores/ title="Tipos de hipervisores">Tipos de hipervisores</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/introduccion-kvm/arquitectura-kvm/ title="Arquitectura de KVM">Arquitectura de KVM</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/virtualizacion-kvm-linux/instalacion-kvm/> Instalación y configuración</a><ul><li><a class=list-link href=/posts/virtualizacion-kvm-linux/instalacion-kvm/instalar-kvm-libvirt/ title="Instalar KVM y libvirt">Instalar KVM y libvirt</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/instalacion-kvm/validar-host-kvm/ title="Validar host KVM">Validar host KVM</a></li></ul></li><li><i data-feather=minus-circle></i><a class="active list-link" href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/> Gestión de máquinas virtuales</a><ul class=active><li><a class=list-link href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/crear-vm-virtinstall/ title="Crear VM con virt-install">Crear VM con virt-install</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/componentes-vm/ title="Componentes de una VM">Componentes de una VM</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/administrar-virsh/ title="Administrar con virsh">Administrar con virsh</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/clonar-y-renombrar-vm/ title="Clonar y renombrar VM">Clonar y renombrar VM</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/ampliar-recursos-vm/ title="Ampliar recursos de una VM">Ampliar recursos de una VM</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/snapshots-kvm/ title="Snapshots en KVM">Snapshots en KVM</a></li><li><a class="active list-link" href=/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/plantilla-debian13/ title="Plantilla maquinas virtuales">Plantilla maquinas virtuales</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/virtualizacion-kvm-linux/redes-kvm/> Redes en KVM</a><ul><li><a class=list-link href=/posts/virtualizacion-kvm-linux/redes-kvm/tipos-redes-kvm/ title="Tipos de redes">Tipos de redes</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/redes-kvm/crear-redes-virtuales-privadas-kvm/ title="Crear redes privadas">Crear redes privadas</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/redes-kvm/crear-interfaz-puente/ title="Crear redes puente">Crear redes puente</a></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/virtualizacion-kvm-linux/almacenamiento-kvm/> Almacenamiento en KVM</a><ul><li><a class=list-link href=/posts/virtualizacion-kvm-linux/almacenamiento-kvm/introduccion-almacenamiento-kvm/ title="Introducción al almacenamiento">Introducción al almacenamiento</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/almacenamiento-kvm/gestion-pools-almacenamiento/ title="Gestión de pools">Gestión de pools</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/almacenamiento-kvm/gestion-volumenes-virsh/ title="Gestión de volúmenes (virsh)">Gestión de volúmenes (virsh)</a></li><li><a class=list-link href=/posts/virtualizacion-kvm-linux/almacenamiento-kvm/redimension-discos-vms/ title="Redimensión de discos (VMs)">Redimensión de discos (VMs)</a></li></ul></li></ul></li><li><i data-feather=plus-circle></i><a class=list-link href=/posts/vpn/> VPN</a><ul><li><a class=list-link href=/posts/vpn/acceso_remoto_strongswang/ title="Acceso remoto Ipsec StrongSwan">Acceso remoto Ipsec StrongSwan</a></li><li><a class=list-link href=/posts/vpn/acceso_remoto_openvpn/ title="Acceso remoto OpenVPN">Acceso remoto OpenVPN</a></li><li><a class=list-link href=/posts/vpn/acceso_remoto_wireguard/ title="Acceso remoto Wireguard">Acceso remoto Wireguard</a></li><li><a class=list-link href=/posts/vpn/comparativa_ovpn_wire/ title="Comparativa OpenVPN y Wireguard">Comparativa OpenVPN y Wireguard</a></li><li><a class=list-link href=/posts/vpn/ipsec_cisco/ title="Site-to-Site IPsec Cisco">Site-to-Site IPsec Cisco</a></li><li><a class=list-link href=/posts/vpn/site_to_site_fortinet/ title="Site-to-Site IPsec Fortinet">Site-to-Site IPsec Fortinet</a></li><li><a class=list-link href=/posts/vpn/site_to_site_openvpn/ title="Site-to-Site OpenVPN">Site-to-Site OpenVPN</a></li><li><a class=list-link href=/posts/vpn/site_to_site_wireguard/ title="Site-to-Site Wireguard">Site-to-Site Wireguard</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/virtualizacion-kvm-linux/gestion-vm/plantillas.png)></div><div class=page-content><div class="author-profile ms-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hu_2aff0fda0501496d.png alt="Author Image"><h5 class=author-name>Francisco Javier Cruces Doval</h5><p class=text-muted>sábado, 18 de octubre de 2025 | 6 minutos</p></div><div class=title><h1>Cómo crear una plantilla de máquina virtual Debian 13</h1></div><div class=tags><ul style=padding-left:0><li class=rounded><a href=/tags/kvm/ class="btn btn-sm btn-info">KVM</a></li><li class=rounded><a href=/tags/virtualizacion/ class="btn btn-sm btn-info">Virtualizacion</a></li><li class=rounded><a href=/tags/libvirt/ class="btn btn-sm btn-info">Libvirt</a></li><li class=rounded><a href=/tags/linux/ class="btn btn-sm btn-info">Linux</a></li><li class=rounded><a href=/tags/vm/ class="btn btn-sm btn-info">VM</a></li><li class=rounded><a href=/tags/templates/ class="btn btn-sm btn-info">Templates</a></li><li class=rounded><a href=/tags/debian13/ class="btn btn-sm btn-info">Debian13</a></li></ul></div><div class=post-content id=post-content><p>Una plantilla de máquina virtual (template) es una imagen preconfigurada del sistema operativo que usamos para desplegar rápidamente nuevas VMs, evitando repeticiones y errores. Aquí veremos cómo crear una plantilla maestra de Debian 13 lista para clonar.</p><hr><h2 id=1-crear-e-instalar-la-vm-base>1 Crear e instalar la VM base</h2><p>Crea una VM limpia de Debian 13, aplica todas las actualizaciones y añade el software común que quieras en todos los clones (agente invitado, utilidades, etc.). Ejemplo mínimo:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Crear la VM base (ajusta CPU, RAM, disco, ISO y red a tu entorno)</span>
</span></span><span style=display:flex><span>virt-install <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name debian13-base <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --memory <span style=color:#ae81ff>4096</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --vcpus <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --disk path<span style=color:#f92672>=</span>/var/lib/libvirt/images/debian13-base.qcow2,size<span style=color:#f92672>=</span>20,format<span style=color:#f92672>=</span>qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --cdrom /var/lib/libvirt/images/debian-13.1.0-amd64-netinst.iso <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --os-variant debian12 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --network network<span style=color:#f92672>=</span>default,model<span style=color:#f92672>=</span>virtio <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --noautoconsole
</span></span></code></pre></div><p>Una vez creada la VM, instala todos los componentes que quieres que tenga esta plantilla: usuarios, paquetes, etc.</p><p>Para ello comprobaré que está corriendo y comenzaré con la instalación:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ virsh list 
</span></span><span style=display:flex><span> Id   Name            State
</span></span><span style=display:flex><span>-------------------------------
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span>    debian13-base   running
</span></span></code></pre></div><p>Me conectaré por SSH a la máquina:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>javiercruces@FJCD-PC:~/Documentos/sentinel <span style=color:#f92672>(</span>feature/kvm<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>prd-eu-central|<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ virsh domifaddr debian13-base
</span></span><span style=display:flex><span> Name       MAC address          Protocol     Address
</span></span><span style=display:flex><span>-------------------------------------------------------------------------------
</span></span><span style=display:flex><span> vnet8      52:54:00:62:d5:6a    ipv4         192.168.122.202/24
</span></span><span style=display:flex><span> -          -                    ipv4         192.168.122.201/24
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~/Documentos/sentinel <span style=color:#f92672>(</span>feature/kvm<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>prd-eu-central|<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ ssh 192.168.122.202
</span></span><span style=display:flex><span>The authenticity of host <span style=color:#e6db74>&#39;192.168.122.202 (192.168.122.202)&#39;</span> can<span style=color:#e6db74>&#39;t be established.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>ED25519 key fingerprint is SHA256:RvOdKE4i1eQNHJ8bdK6RoYl9GckeGN2xY6X/IsPvMHI.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>This key is not known by any other names.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Warning: Permanently added &#39;</span>192.168.122.202<span style=color:#e6db74>&#39; (ED25519) to the list of known hosts.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>javiercruces@192.168.122.202&#39;</span>s password: 
</span></span><span style=display:flex><span>Linux debian13-base 6.12.48+deb13-amd64 <span style=color:#75715e>#1 SMP PREEMPT_DYNAMIC Debian 6.12.48-1 (2025-09-20) x86_64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style=display:flex><span>the exact distribution terms <span style=color:#66d9ef>for</span> each program are described in the
</span></span><span style=display:flex><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style=display:flex><span>permitted by applicable law.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>javiercruces@debian13-base:~$ 
</span></span></code></pre></div><p>En mi caso, voy a actualizarla a la última versión e instalaré las qemu-utils. Además, como esta máquina solo la voy a utilizar para pruebas, configuraré mi clave SSH para poder conectarme a ella sin necesidad de introducir mi contraseña.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Dentro de la VM he realizado los siguientes comandos :</span>
</span></span><span style=display:flex><span>sudo apt update <span style=color:#f92672>&amp;&amp;</span> sudo apt -y full-upgrade
</span></span><span style=display:flex><span>sudo apt install -y qemu-guest-agent cloud-guest-utils
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Dentro de nuestro usuario generamos los siguientes ficheros y asignamos los permisos:</span>
</span></span><span style=display:flex><span>javiercruces@debian13-base:~$ mkdir -p ~/.ssh
</span></span><span style=display:flex><span>javiercruces@debian13-base:~$ touch ~/.ssh/authorized_keys
</span></span><span style=display:flex><span>javiercruces@debian13-base:~$ chmod <span style=color:#ae81ff>700</span> ~/.ssh
</span></span><span style=display:flex><span>javiercruces@debian13-base:~$ chmod <span style=color:#ae81ff>600</span> ~/.ssh/authorized_keys
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Con este comando añadimos la clave pública que queremos utilizar en la VM</span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~$ ssh-copy-id -i ~/.ssh/jcruces.pub javiercruces@192.168.122.202   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Por último, compruebo que puedo conectarme usando la clave SSH. Recuerda desactivar en el servicio SSH la autenticación por contraseña.</span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~ <span style=color:#f92672>[</span>prd-eu-central|<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ ssh javiercruces@192.168.122.202
</span></span><span style=display:flex><span>Linux debian13-base 6.12.48+deb13-amd64 <span style=color:#75715e>#1 SMP PREEMPT_DYNAMIC Debian 6.12.48-1 (2025-09-20) x86_64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>The programs included with the Debian GNU/Linux system are free software;
</span></span><span style=display:flex><span>the exact distribution terms <span style=color:#66d9ef>for</span> each program are described in the
</span></span><span style=display:flex><span>individual files in /usr/share/doc/*/copyright.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span></span><span style=display:flex><span>permitted by applicable law.
</span></span><span style=display:flex><span>Last login: Sat Oct <span style=color:#ae81ff>18</span> 16:35:26 <span style=color:#ae81ff>2025</span> from 192.168.122.1
</span></span></code></pre></div><p>Apaga la VM base cuando termines:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>javiercruces@FJCD-PC:~$ virsh shutdown debian13-base
</span></span><span style=display:flex><span>Domain <span style=color:#e6db74>&#39;debian13-base&#39;</span> is being shutdown
</span></span></code></pre></div><hr><h2 id=2-generalizar-la-imagen-con-virt-sysprep>2 Generalizar la imagen con virt-sysprep</h2><p>La generalización elimina y regenera elementos que deben ser únicos en cada clon (machine-id, claves SSH de host, hostname, logs, caches, etc.). Para Linux usaremos <code>virt-sysprep</code> (paquete <code>libguestfs-tools</code>).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Generalizar indicando el dominio (VM debe estar apagada)</span>
</span></span><span style=display:flex><span>virt-sysprep -d debian13-base <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --hostname plantilla-debian13 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --firstboot-command <span style=color:#e6db74>&#34;dpkg-reconfigure openssh-server&#34;</span>
</span></span></code></pre></div><p>Notas:</p><ul><li><code>--hostname</code> fija el nombre de host de la plantilla.</li><li><code>--firstboot-command</code> ejecuta el comando al primer arranque del clon para regenerar claves de SSH del host.</li><li>Puedes añadir o quitar operaciones con <code>--enable/--operations</code> (ver <code>virt-sysprep --list-operations</code>).</li></ul><hr><h2 id=3-compactar-la-imagen-con-virt-sparsify>3 Compactar la imagen con virt-sparsify</h2><p>Para ahorrar espacio, compacta la imagen (elimina bloques vacíos) y opcionalmente comprímela.</p><p>Con la instalación base, en mi caso la imagen ocupa alrededor de 2 GB reales.
Ten cuidado, porque si intentas comprobar su tamaño con ls, verás el tamaño lógico total que puede alcanzar la imagen, no el espacio que realmente está usando:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Así verías el tamaño lógico total que puede ocupar el disco de la VM</span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~ <span style=color:#f92672>[</span>prd-eu-central|<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ sudo ls -lh /var/lib/libvirt/images/ | grep debian13-base
</span></span><span style=display:flex><span>-rw------- <span style=color:#ae81ff>1</span> root         root  21G oct <span style=color:#ae81ff>18</span> 16:47 debian13-base.qcow2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Así verías el tamaño real que ocupa el disco</span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~ <span style=color:#f92672>[</span>prd-eu-central|<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ sudo du -h --max-depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> /var/lib/libvirt/images/debian13-base.qcow2
</span></span><span style=display:flex><span>2,0G	/var/lib/libvirt/images/debian13-base.qcow2
</span></span></code></pre></div><p>Ahora vamos a comprimir la imagen base para que ocupe menos:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo virt-sparsify --compress <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  /var/lib/libvirt/images/debian13-base.qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  /var/lib/libvirt/images/plantilla-debian13-comprimida.qcow2
</span></span></code></pre></div><p>Ten en cuenta que antes de reemplazar la imagen real por la comprimida, debes probar que una máquina es capaz de arrancar usando este nuevo disco.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Reemplazar la imagen por la compactada</span>
</span></span><span style=display:flex><span>sudo mv /var/lib/libvirt/images/plantilla-debian13-comprimida.qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  /var/lib/libvirt/images/debian13-base.qcow2
</span></span></code></pre></div><p>Ahora, si volvemos a comprobar el tamaño de la imagen, veremos que ha pasado de ocupar 2GB a 586MB:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo du -h --max-depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> /var/lib/libvirt/images/debian13-base.qcow2
</span></span><span style=display:flex><span>586M	/var/lib/libvirt/images/debian13-base.qcow2
</span></span></code></pre></div><hr><h2 id=4-marcar-la-imagen-como-solo-lectura-evitar-arrancar-la-plantilla>4 Marcar la imagen como solo lectura (evitar arrancar la plantilla)</h2><p>Para no perder la plantilla, marca la imagen como solo lectura. Si alguien intenta arrancarla por error, fallará.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo chmod <span style=color:#ae81ff>444</span> /var/lib/libvirt/images/debian13-base.qcow2
</span></span></code></pre></div><p>Además, si quieres, renombra el dominio para identificar que es una plantilla. En mi caso no lo haré:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>virsh domrename debian13-base plantilla-debian13
</span></span></code></pre></div><hr><h2 id=5-crear-clones-a-partir-de-la-plantilla>5 Crear clones a partir de la plantilla</h2><p>Tienes dos formas principales:</p><ul><li>Clonación completa (full): imagen independiente; ocupa tanto como el original.</li><li>Clonación enlazada (linked): crea una capa overlay sobre la plantilla (sólo lectura); ocupa menos, depende de la base.</li></ul><h3 id=51-clonación-completa>5.1 Clonación completa</h3><p>Así crearemos un clon completo utilizando el disco de la plantilla que ocupará tanto como el original:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo virt-clone --original debian13-base --name debian13-clonacion-completa <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --file /var/lib/libvirt/images/debian13-clonacion-completa.qcow2
</span></span></code></pre></div><p>Con este comando tendremos una nueva máquina virtual con los mismos componentes que la plantilla.</p><p>Antes de arrancar la clonación como un usuario no-root, asegúrate de ajustar propietario y permisos del fichero de disco recién creado. En muchas distribuciones el proceso QEMU/libvirt necesita que el archivo pertenezca al usuario/grupo que ejecuta el hypervisor (por ejemplo <code>libvirt-qemu:libvirt-qemu</code> o <code>qemu:qemu</code>). Si no se corrigen estos permisos, al iniciar la VM con un usuario distinto de root puede fallar.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo chown libvirt-qemu:libvirt-qemu /var/lib/libvirt/images/debian13-clonacion-completa.qcow2
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo chmod <span style=color:#ae81ff>660</span> /var/lib/libvirt/images/debian13-clonacion-completa.qcow2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo virsh start debian13-clonacion-completa
</span></span><span style=display:flex><span>Domain <span style=color:#e6db74>&#39;debian13-clonacion-completa&#39;</span> started
</span></span></code></pre></div><p>Si tu distribución usa otro usuario/grupo para el proceso qemu (por ejemplo <code>qemu:qemu</code>), sustituye <code>libvirt-qemu:libvirt-qemu</code> por el par correcto. Además, si usas SELinux o AppArmor revisa las políticas que puedan bloquear el acceso al fichero.</p><h3 id=52-clonación-enlazada>5.2 Clonación enlazada</h3><p>Podemos hacer esto de dos formas distintas.</p><p>La primera es generar el disco como backing file a la plantilla (solo lectura) usando qemu-img:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo qemu-img create -f qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -F qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -b /var/lib/libvirt/images/debian13-base.qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  /var/lib/libvirt/images/debian13-clonacion-enlazada.qcow2
</span></span></code></pre></div><p>Tras generar el disco, creamos la máquina virtual haciendo uso de este:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo virt-install <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name debian13-clonacion-enlazada <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --memory <span style=color:#ae81ff>4096</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --vcpus <span style=color:#ae81ff>2</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --disk path<span style=color:#f92672>=</span>/var/lib/libvirt/images/debian13-clonacion-enlazada.qcow2,format<span style=color:#f92672>=</span>qcow2 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --os-variant debian12 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --network network<span style=color:#f92672>=</span>default,model<span style=color:#f92672>=</span>virtio <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --import <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --noautoconsole
</span></span></code></pre></div><p>Antes de arrancar la máquina clonada, ajusta propietario y permisos del fichero creado para evitar errores de acceso cuando el hipervisor (qemu/libvirt) no corra como root. En muchos sistemas el proceso corre como <code>libvirt-qemu:libvirt-qemu</code> o <code>qemu:qemu</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo chown libvirt-qemu:libvirt-qemu /var/lib/libvirt/images/debian13-clonacion-enlazada.qcow2
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo chmod <span style=color:#ae81ff>660</span> /var/lib/libvirt/images/debian13-clonacion-enlazada.qcow2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>javiercruces@FJCD-PC:~$ sudo virsh start debian13-clonacion-enlazada
</span></span><span style=display:flex><span>Domain <span style=color:#e6db74>&#39;debian13-clonacion-enlazada&#39;</span> started
</span></span></code></pre></div><p>Si tu distribución usa otro usuario/grupo para qemu (por ejemplo <code>qemu:qemu</code>), sustituye <code>libvirt-qemu:libvirt-qemu</code> por el par correcto. Revisa también SELinux/AppArmor si persisten errores.</p><hr><h2 id=referencias>Referencias</h2><ul><li><p><a href=https://github.com/josedom24/curso_virtualizacion_linux target=_blank rel=noopener>curso_virtualizacion_linux — GitHub</a></p></li><li><p><a href=https://libguestfs.org/virt-sysprep.1.html target=_blank rel=noopener>virt-sysprep (libguestfs)</a></p></li><li><p><a href=https://libguestfs.org/virt-sparsify.1.html target=_blank rel=noopener>virt-sparsify (libguestfs)</a></p></li><li><p><a href=https://libvirt.org/manpages/virt-clone.html target=_blank rel=noopener>virt-clone (libvirt)</a></p></li><li><p><a href=https://libguestfs.org/virt-customize.1.html target=_blank rel=noopener>virt-customize (libguestfs)</a></p></li><li><p><a href=https://www.qemu.org/docs/master/tools/qemu-img.html target=_blank rel=noopener>qemu-img (resize/create/backing)</a></p></li></ul></div><div class="row ps-3 pe-3"><div class="col-md-6 share-buttons"><strong>Compartir en:</strong>
<a class="btn icon-button bg-facebook" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fwww.javiercd.es%2fposts%2fvirtualizacion-kvm-linux%2fgestion-maquinas-kvm%2fplantilla-debian13%2fplantilla-debian13%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn icon-button bg-twitter" href="https://twitter.com/share?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fvirtualizacion-kvm-linux%2fgestion-maquinas-kvm%2fplantilla-debian13%2fplantilla-debian13%2f&text=C%c3%b3mo%20crear%20una%20plantilla%20de%20m%c3%a1quina%20virtual%20Debian%2013&via=Atlas" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn icon-button bg-reddit" href="https://reddit.com/submit?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fvirtualizacion-kvm-linux%2fgestion-maquinas-kvm%2fplantilla-debian13%2fplantilla-debian13%2f&title=C%c3%b3mo%20crear%20una%20plantilla%20de%20m%c3%a1quina%20virtual%20Debian%2013" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn icon-button bg-linkedin" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fwww.javiercd.es%2fposts%2fvirtualizacion-kvm-linux%2fgestion-maquinas-kvm%2fplantilla-debian13%2fplantilla-debian13%2f&title=C%c3%b3mo%20crear%20una%20plantilla%20de%20m%c3%a1quina%20virtual%20Debian%2013" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn icon-button bg-whatsapp" href="https://api.whatsapp.com/send?text=C%c3%b3mo%20crear%20una%20plantilla%20de%20m%c3%a1quina%20virtual%20Debian%2013 https%3a%2f%2fwww.javiercd.es%2fposts%2fvirtualizacion-kvm-linux%2fgestion-maquinas-kvm%2fplantilla-debian13%2fplantilla-debian13%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn icon-button" href="mailto:?subject=C%c3%b3mo%20crear%20una%20plantilla%20de%20m%c3%a1quina%20virtual%20Debian%2013&body=https%3a%2f%2fwww.javiercd.es%2fposts%2fvirtualizacion-kvm-linux%2fgestion-maquinas-kvm%2fplantilla-debian13%2fplantilla-debian13%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/javierasping/sentinel/edit/main/content/posts/virtualizacion-kvm-linux/gestion-maquinas-kvm/plantilla-debian13/plantilla-debian13.md title="Mejorar esta página" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Mejorar esta página</a></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn type=button data-bs-toggle=tooltip data-bs-placement=left title="Scroll to top"><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center ps-3">Contenido</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#1-crear-e-instalar-la-vm-base>1 Crear e instalar la VM base</a></li><li><a href=#2-generalizar-la-imagen-con-virt-sysprep>2 Generalizar la imagen con virt-sysprep</a></li><li><a href=#3-compactar-la-imagen-con-virt-sparsify>3 Compactar la imagen con virt-sparsify</a></li><li><a href=#4-marcar-la-imagen-como-solo-lectura-evitar-arrancar-la-plantilla>4 Marcar la imagen como solo lectura (evitar arrancar la plantilla)</a></li><li><a href=#5-crear-clones-a-partir-de-la-plantilla>5 Crear clones a partir de la plantilla</a><ul><li><a href=#51-clonación-completa>5.1 Clonación completa</a></li><li><a href=#52-clonación-enlazada>5.2 Clonación enlazada</a></li></ul></li><li><a href=#referencias>Referencias</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-start"><div class="col-md-4 col-sm-12"><h5>Navegación</h5><ul><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#about>Sobre mi</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#skills>Competencias</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#education>Educación</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=smooth-scroll href=https://www.javiercd.es/#accomplishments>Certificaciones</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contacto</h5><ul><li><a href=mailto:contacto@javiercd.es target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>contacto@javiercd.es</span></a></li><li><a href=https://github.com/javierasping target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>javierasping</span></a></li><li><a href=https://www.linkedin.com/in/javiercd target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Francisco Javier Cruces Doval</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Aviso de responsabilidad:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-start"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu_b3360284c55cf72d.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-end"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Funcionando con
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.88e12b83fd69c92e719c3aa554a42e6d0f20fb72d76bd329f31250ef3bd11899.js integrity="sha256-iOErg/1pyS5xnDqlVKQubQ8g+3LXa9Mp8xJQ7zvRGJk=" defer></script></body></html>