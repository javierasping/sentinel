<!doctype html><html lang=es><head><title>Configuración servidor DNS en Debian</title>
<meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><link rel=stylesheet href=/application.5b7777e57c70f92a6339db87ad8b77d43266b3f01b9b591a1fac1f495003fb3c.css integrity="sha256-W3d35Xxw+SpjOduHrYt31DJms/Abm1kaH6wfSVAD+zw="><link rel=icon type=image/png href=/images/site/avatar_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_q75_box.jpg><meta property="og:title" content="Configuración servidor DNS en Debian"><meta property="og:description" content="Configuración del servidor DNS en nuestro escenario básico bajo debian 10"><meta property="og:type" content="article"><meta property="og:url" content="http://www.javiercd.es/posts/servicios/dns/dns/"><meta property="og:image" content="http://www.javiercd.es"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-08T10:00:00+00:00"><meta property="article:modified_time" content="2023-09-08T10:00:00+00:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://www.javiercd.es"><meta name=twitter:title content="Configuración servidor DNS en Debian"><meta name=twitter:description content="Configuración del servidor DNS en nuestro escenario básico bajo debian 10"><meta name=description content="Configuración del servidor DNS en nuestro escenario básico bajo debian 10"></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span>
</button>
<a class=navbar-brand href=/><img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png alt=Logo>
Atlas</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme">
</a><a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/masthead_hud72a20250efce9adf5aa46631dba75d3_2990_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=Búsqueda data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>Posts</a></li><div class=subtree><li><i class="fas fa-plus-circle"></i><a href=/posts/iaw/> Aplicaciones webs</a><ul><li><a href=/posts/iaw/lamp/ title="Instalación pila LAMP">Instalación pila LAMP</a></li><li><a href=/posts/iaw/wordpress/ title=Wordpress>Wordpress</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/redes/> Redes</a><ul><li><a href=/posts/redes/comandos_de_supervision_de_redes/ title="Comandos de supervisión de redes">Comandos de supervisión de redes</a></li><li><a href=/posts/redes/instalacion_wireshark_gns3/ title="Instalacion GNS y Wireshark">Instalacion GNS y Wireshark</a></li><li><a href=/posts/redes/underworld/ title=Underworld>Underworld</a></li></ul></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/servicios/> Servicios</a><ul class=active><li><a href=/posts/servicios/apache/ title=Apache>Apache</a></li><li><a href=/posts/servicios/dhcp/ title=DHCP>DHCP</a></li><li><a class=active href=/posts/servicios/dns/ title=DNS>DNS</a></li><li><a href=/posts/servicios/ftp/ title=FTP>FTP</a></li><li><a href=/posts/servicios/nat_iptables/ title="NAT con iptables">NAT con iptables</a></li><li><a href=/posts/servicios/ssh/ title=SSH>SSH</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/servicios/dns/portada-dns.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/john_hud72a20250efce9adf5aa46631dba75d3_2990_120x120_fit_box_3.png alt="Author Image"><h5 class=author-name>Francisco Javier Cruces Doval</h5><p>viernes, 8 de septiembre de 2023</p></div><div class=title><h1>Configuración servidor DNS en Debian</h1></div><div class=taxonomy-terms><ul style=padding-left:0><li class=rounded><a href=/tags/servicios/ class="btn, btn-sm">Servicios</a></li><li class=rounded><a href=/tags/nat/ class="btn, btn-sm">NAT</a></li><li class=rounded><a href=/tags/smr/ class="btn, btn-sm">SMR</a></li><li class=rounded><a href=/tags/dhcp/ class="btn, btn-sm">DHCP</a></li><li class=rounded><a href=/tags/snat/ class="btn, btn-sm">SNAT</a></li><li class=rounded><a href=/tags/dns/ class="btn, btn-sm">DNS</a></li><li class=rounded><a href=/tags/bind9/ class="btn, btn-sm">BIND9</a></li><li class=rounded><a href=/tags/dnsmasq/ class="btn, btn-sm">DNSMASQ</a></li></ul></div><div class=post-content id=post-content><h1 id=configuración-servidor-dns-en-debian>Configuración servidor DNS en Debian</h1><h2 id=dnsmasq>Dnsmasq</h2><p>El paquete dnsmasq permite poner en marcha un servidor DNS de una forma muy sencilla. Simplemente instalando y arrancando el servicio dnsmasq, sin realizar ningún tipo de configuración adicional, nuestro PC se convertirá en un servidor caché DNS y además, resolverá los nombres que tengamos configurados en el archivo /etc/hosts de nuestro servidor. La resolución funcionará tanto en sentido directo como en sentido inverso, es decir, resolverá la IP dado un nombre de PC y el nombre del PC dada la IP.</p><h3 id=instalación>Instalación</h3><p>Para instalarlo solo sera necesario introducir el siguiente comando :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.048.png alt></p><h3 id=configuración>Configuración</h3><p>A continuación, editamos el fichero /etc/dnsmasq.conf y modificamos las siguientes líneas:</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.049.png alt></p><p>1.Descomentamos strict-order para que se realicen las peticiones DNS a los servidores que aparecen en el fichero /etc/resolv.conf en el orden en él aparecen.</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.050.png alt></p><p>2.Incluimos las interfaces de red que deben aceptar peticiones DNS, descomentar la línea interface por ejemplo: interface=eth0</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.051.png alt></p><p>Ahora crearemos nuestro archivo de configuración :</p><p>3.Creamos el fichero de configuración de nuestra zona :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.052.png alt></p><p>4.El dominio que hemos elegido es iesgn.org</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.053.png alt></p><p>5.Suponemos que el nombre del servidor es miservidor.</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.054.png alt></p><p>6.Vamos a suponer que tenemos un servidor ftp que se llame ftp.iesgn.org y que está en 192.168.1.201 (esto es ficticio) y que tenemos dos sitios webs: <a href=https://www.iesgn.org target=_blank rel=noopener>www.iesgn.org</a> y departamentos.iesgn.org.</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.055.png alt></p><p>7.Además queremos nombrar al cliente que tenía asignada una reserva: lisa.</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.056.png alt></p><p>8.Reiniciamos el servicio</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.057.png alt></p><h3 id=modificacion-en-el-servidor-dhcp>Modificacion en el servidor DHCP</h3><p>Configura los clientes e indica que su DNS es nuestro servidor. Si tienes un servidor DHCP modificarlo para que envíe el nuevo DNS a los clientes.</p><p>Editamos el fichero :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.058.png alt></p><p>Y reiniciamos el servicio :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.059.png alt></p><p>Ahora comprobaremos si el cliente nos ha cambiado el dns mirando el siguiente archivo :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.060.png alt></p><p>Se nos ha cambiado satisfactoriamente .</p><h3 id=comandos-para-comprobar-funcionamiento-dns>Comandos para comprobar funcionamiento dns</h3><p>Comprueba el funcionamiento usando el comando dig/nslookup desde los clientes preguntando por los distintos nombres. Comprueba que el servidor DNS hace de forwarder preguntando con dig/nslookup la dirección ip de <a href=https://www.josedomingo.org target=_blank rel=noopener>www.josedomingo.org</a>.</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.061.png alt></p><p>Para la pagina de Jose domingo la respuesta es no autorizada porque nuestro servidor no tiene la resolución en su fichero y tiene que utilizar un forwarder</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.062.png alt></p><p>Como ves arriba yo he creado mi propia zona y a pesar de haber seguido los pasos de esta <a href=https://www.josedomingo.org/pledin/2020/12/servidor-dns-dnsmasq/ target=_blank rel=noopener>pagina</a> de Jose domingo , no he conseguido que las respuestas estén autorizadas .</p><p>He creado el archivo dns.conf .</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.063.png alt></p><p>Y he creado mi zona :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.064.png alt></p><p>También he probado mas cosas sin embargo la única forma que he conseguido que me de respuesta autorizada es teniendo solo las resoluciones en el fichero host del servidor , sin crear mi zona .</p><h2 id=dns-bind-9>DNS BIND 9</h2><h3 id=instalación-1>Instalación</h3><p>Lo primero que haremos sera desinstalar dnsmasq ya que ambos no son compatibles :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.065.png alt></p><p>Ademas podemos ver que nos dice que el directorio /etc/dnsmasq.d/ al no estar vació no se ha borrado seria bueno que lo borrásemos manualmente para eliminar todo rastro de anteriores configuraciones :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.066.png alt></p><p>Ahora vamos a instalarlos bind:</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.067.png alt></p><h3 id=configuración-1>Configuración</h3><p>Ahora vamos a editar el fichero /etc/bind/named.conf.local donde crearemos las zonas (directas e inversas). En el caso de la práctica nos piden una directa (isgn.com) y otra inversa (red 192.168.1).</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.068.png alt></p><p>Añadiremos las siguientes líneas a dicho fichero :</p><p>En el directorio / etc/bind están los ficheros db.empty y db.127 (ficheros de configuración de la zona directa e inversa respectivamente). Los copiamos al directorio / var/cache/bind para empezar a añadir los registros</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.069.png alt></p><p>Modificamos el fichero / var/cache/bind/db.isgn e incluimos las siguientes líneas para la resolución directa :</p><p>*javiercruces es el nombre de mi maquina lo he cambiado para facilitar las cosas</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.070.png alt></p><p>Ahora haremos lo mismo para la resolución inversa :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.071.png alt></p><p>Ahora reiniciaremos el servicio para que se apliquen los cambios :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.072.png alt></p><p>Ademas para asegurarnos de que hemos realizado bien la configuración vamos a mirar el estado del servicio para ver si nuestras zonas están funcionando :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.073.png alt></p><p>Este paso es opcional , pero gracias a revisar esto he descubierto porque no me hacia la resolución inversa y gracias a ver las zonas que estaban cargadas me di cuenta de que el error estaba en el fichero de configuración /etc/bind/named.conf.local y pude solucionarlo .</p><h3 id=reenviador>Reenviador</h3><p>Hasta ahora, sólo nos resolvería los nombres e ip de nuestra red local. Si queremos configurar un reenviador al que preguntar en caso de que el DNS local no pueda darnos la respuesta, debemos editar el fichero nano / etc/bind/named.conf.options y añadir lo siguiente:</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.074.png alt></p><p>Antes de hacer este apartado aclarar que como en el apartado de dnsmasq ya comentamos el fichero host y modificamos la configuración del dhcp para que asigne el dns automáticamente , lo omitiré de esta parte.</p><h4 id=comandos-para-comprobar-el-funcionamiento-del-servicio>Comandos para comprobar el funcionamiento del servicio</h4><p>Comprueba el funcionamiento usando el comando dig/nslookup desde los clientes preguntando por los distintos nombres. Comprueba que el servidor DNS hace de forwarder preguntando con dig/nslookup la dirección ip de <a href=https://www.josedomingo.org target=_blank rel=noopener>www.josedomingo.org</a> .</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.075.png alt></p><p>Vemos aquí que las respuestas son correctas , las que están en nuestro servidor estas autorizadas mientras que la pagina de Jose domingo nos la ha echo un forwarder .</p><p>Ahora haré las mismas peticiones pero inversas :</p><p><img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.076.png alt>
<img src=../img/Aspose.Words.5fca9cc1-3c81-4853-a5ed-a70b0122341b.077.png alt></p><p>Con esto hemos comprobado que el servidor dns funciona correctamente .</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Compartir en:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fwww.javiercd.es%2fposts%2fservicios%2fdns%2fdns%2f" target=_blank><i class="fab fa-facebook"></i>
</a><a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=http%3a%2f%2fwww.javiercd.es%2fposts%2fservicios%2fdns%2fdns%2f&text=Configuraci%c3%b3n%20servidor%20DNS%20en%20Debian&via=Atlas" target=_blank><i class="fab fa-twitter"></i>
</a><a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=http%3a%2f%2fwww.javiercd.es%2fposts%2fservicios%2fdns%2fdns%2f&title=Configuraci%c3%b3n%20servidor%20DNS%20en%20Debian" target=_blank><i class="fab fa-reddit"></i>
</a><a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=http%3a%2f%2fwww.javiercd.es%2fposts%2fservicios%2fdns%2fdns%2f&title=Configuraci%c3%b3n%20servidor%20DNS%20en%20Debian" target=_blank><i class="fab fa-linkedin"></i>
</a><a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Configuraci%c3%b3n%20servidor%20DNS%20en%20Debian http%3a%2f%2fwww.javiercd.es%2fposts%2fservicios%2fdns%2fdns%2f" target=_blank><i class="fab fa-whatsapp"></i>
</a><a class="btn btn-sm email-btn" href="mailto:?subject=Configuraci%c3%b3n%20servidor%20DNS%20en%20Debian&body=http%3a%2f%2fwww.javiercd.es%2fposts%2fservicios%2fdns%2fdns%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/javierasping/sentinel/edit/main/content/posts/servicios/dns/dns.md title="Mejorar esta página" target=_blank rel=noopener><i class="fas fa-code-branch"></i>
Mejorar esta página</a></div></div><hr><div class="row next-prev-navigator"></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">Contenido</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#dnsmasq>Dnsmasq</a><ul><li><a href=#instalación>Instalación</a></li><li><a href=#configuración>Configuración</a></li><li><a href=#modificacion-en-el-servidor-dhcp>Modificacion en el servidor DHCP</a></li><li><a href=#comandos-para-comprobar-funcionamiento-dns>Comandos para comprobar funcionamiento dns</a></li></ul></li><li><a href=#dns-bind-9>DNS BIND 9</a><ul><li><a href=#instalación-1>Instalación</a></li><li><a href=#configuración-1>Configuración</a></li><li><a href=#reenviador>Reenviador</a><ul><li><a href=#comandos-para-comprobar-el-funcionamiento-del-servicio>Comandos para comprobar el funcionamiento del servicio</a></li></ul></li></ul></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>Navegación</h5><ul><li class=nav-item><a class=smooth-scroll href=http://www.javiercd.es#about>Sobre mi</a></li><li class=nav-item><a class=smooth-scroll href=http://www.javiercd.es#skills>Competencias</a></li><li class=nav-item><a class=smooth-scroll href=http://www.javiercd.es#education>Educación</a></li><li class=nav-item><a class=smooth-scroll href=http://www.javiercd.es#recent-posts>Últimas publicaciones</a></li><li class=nav-item><a class=smooth-scroll href=http://www.javiercd.es#accomplishments>Certificaciones</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>Contacto</h5><ul><li><a href=mailto:contacto@javiercd.es target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>contacto@javiercd.es</span></a></li><li><a href=https://github.com/javierasping target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>javierasping</span></a></li><li><a href=https://www.linkedin.com/in/javiercd target=_blank rel=noopener><span><i class="fab fa-linkedin"></i></span> <span>Francisco Javier Cruces Doval</span></a></li></ul></div></div></div><hr><div class=container><p id=disclaimer><strong>Aviso de responsabilidad:</strong> This theme is under MIT license. So, you can use it for non-commercial, commercial, or private uses. You can modify or distribute the theme without requiring any permission from the theme author. However, the theme author does not provide any warranty or takes any liability for any issue with the theme.</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2023 Copyright.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>Funcionando con
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.7827999695f14e82f7113bf5eae91032d5ae9d880af86097d1d692dde09fb28d.js integrity="sha256-eCeZlpXxToL3ETv16ukQMtWunYgK+GCX0daS3eCfso0=" defer></script></body></html>